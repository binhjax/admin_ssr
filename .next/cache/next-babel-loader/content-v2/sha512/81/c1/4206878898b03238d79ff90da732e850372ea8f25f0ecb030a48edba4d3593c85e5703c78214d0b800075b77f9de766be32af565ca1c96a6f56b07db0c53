{"ast":null,"code":"import \"antd/lib/card/style\";\nimport _Card from \"antd/lib/card\";\nimport \"antd/lib/table/style\";\nimport _Table from \"antd/lib/table\";\nimport \"antd/lib/badge/style\";\nimport _Badge from \"antd/lib/badge\";\nimport \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/col/style\";\nimport _Col from \"antd/lib/col\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nimport \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\n\nvar _jsxFileName = \"/Users/nguyenthanhbinh/Work/vnshop/admin/src/pages/user/UserList.js\",\n    _dec,\n    _class,\n    _temp;\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { PureComponent } from 'react';\nimport { Form } from '@ant-design/compatible';\nimport '@ant-design/compatible/assets/index.css';\nimport PButton from '@/components/PermButton';\nimport PageHeaderLayout from '../../layouts/PageHeaderLayout';\nimport UserCard from './UserCard';\nimport RoleSelect from './RoleSelect';\nimport { formatDate } from '../../utils/utils';\nimport styles from './UserList.less';\nimport WithDva from '../../utils/store'; // @connect(state => ({\n//   loading: state.loading.models.user,\n//   user: state.user,\n// }))\n\nlet UserList = (_dec = Form.create(), _dec(_class = (_temp = class UserList extends PureComponent {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {\n      selectedRowKeys: [],\n      selectedRows: []\n    });\n\n    _defineProperty(this, \"onItemDisableClick\", item => {\n      this.dispatch({\n        type: 'user/changeStatus',\n        payload: {\n          id: item.id,\n          status: 2\n        }\n      });\n    });\n\n    _defineProperty(this, \"onItemEnableClick\", item => {\n      this.dispatch({\n        type: 'user/changeStatus',\n        payload: {\n          id: item.id,\n          status: 1\n        }\n      });\n    });\n\n    _defineProperty(this, \"onItemEditClick\", item => {\n      this.dispatch({\n        type: 'user/loadForm',\n        payload: {\n          type: 'E',\n          id: item.id\n        }\n      });\n    });\n\n    _defineProperty(this, \"onAddClick\", () => {\n      this.dispatch({\n        type: 'user/loadForm',\n        payload: {\n          type: 'A'\n        }\n      });\n    });\n\n    _defineProperty(this, \"clearSelectRows\", () => {\n      const {\n        selectedRowKeys\n      } = this.state;\n\n      if (selectedRowKeys.length === 0) {\n        return;\n      }\n\n      this.setState({\n        selectedRowKeys: [],\n        selectedRows: []\n      });\n    });\n\n    _defineProperty(this, \"onItemDelClick\", item => {\n      _Modal.confirm({\n        title: `确定删除【用户数据：${item.user_name}】？`,\n        okText: '确认',\n        okType: 'danger',\n        cancelText: '取消',\n        onOk: this.onDelOKClick.bind(this, item.id)\n      });\n    });\n\n    _defineProperty(this, \"handleTableSelectRow\", (record, selected) => {\n      const keys = [];\n      const rows = [];\n\n      if (selected) {\n        keys.push(record.id);\n        rows.push(record);\n      }\n\n      this.setState({\n        selectedRowKeys: keys,\n        selectedRows: rows\n      });\n    });\n\n    _defineProperty(this, \"onTableChange\", pagination => {\n      this.dispatch({\n        type: 'user/fetch',\n        pagination: {\n          current: pagination.current,\n          pageSize: pagination.pageSize\n        }\n      });\n      this.clearSelectRows();\n    });\n\n    _defineProperty(this, \"onResetFormClick\", () => {\n      const {\n        form\n      } = this.props;\n      form.resetFields();\n      this.dispatch({\n        type: 'user/fetch',\n        search: {},\n        pagination: {}\n      });\n    });\n\n    _defineProperty(this, \"onSearchFormSubmit\", e => {\n      if (e) {\n        e.preventDefault();\n      }\n\n      const {\n        form\n      } = this.props;\n      form.validateFields({\n        force: true\n      }, (err, values) => {\n        if (err) {\n          return;\n        }\n\n        const formData = _objectSpread({}, values);\n\n        if (formData.roleIDs) {\n          formData.roleIDs = formData.roleIDs.map(v => v.role_id).join(',');\n        }\n\n        this.dispatch({\n          type: 'user/fetch',\n          search: formData,\n          pagination: {}\n        });\n        this.clearSelectRows();\n      });\n    });\n\n    _defineProperty(this, \"onDataFormSubmit\", data => {\n      this.dispatch({\n        type: 'user/submit',\n        payload: data\n      });\n      this.clearSelectRows();\n    });\n\n    _defineProperty(this, \"onDataFormCancel\", () => {\n      this.dispatch({\n        type: 'user/changeFormVisible',\n        payload: false\n      });\n    });\n\n    _defineProperty(this, \"dispatch\", action => {\n      const {\n        dispatch\n      } = this.props;\n      dispatch(action);\n    });\n  }\n\n  componentDidMount() {\n    this.dispatch({\n      type: 'user/fetch',\n      search: {},\n      pagination: {}\n    });\n  }\n\n  onDelOKClick(id) {\n    this.dispatch({\n      type: 'user/del',\n      payload: {\n        id\n      }\n    });\n    this.clearSelectRows();\n  }\n\n  renderDataForm() {\n    return __jsx(UserCard, {\n      onCancel: this.onDataFormCancel,\n      onSubmit: this.onDataFormSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 12\n      }\n    });\n  }\n\n  renderSearchForm() {\n    const {\n      form: {\n        getFieldDecorator\n      }\n    } = this.props;\n    return __jsx(Form, {\n      onSubmit: this.onSearchFormSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 7\n      }\n    }, __jsx(_Row, {\n      gutter: 16,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 9\n      }\n    }, __jsx(_Col, {\n      span: 8,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 11\n      }\n    }, __jsx(Form.Item, {\n      label: \"\\u6A21\\u7CCA\\u67E5\\u8BE2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 13\n      }\n    }, getFieldDecorator('queryValue')(__jsx(_Input, {\n      placeholder: \"\\u8BF7\\u8F93\\u5165\\u9700\\u8981\\u67E5\\u8BE2\\u7684\\u5185\\u5BB9\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 48\n      }\n    })))), __jsx(_Col, {\n      span: 8,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 11\n      }\n    }, __jsx(Form.Item, {\n      label: \"\\u6240\\u5C5E\\u89D2\\u8272\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 13\n      }\n    }, getFieldDecorator('roleIDs')(__jsx(RoleSelect, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 67\n      }\n    })))), __jsx(_Col, {\n      span: 8,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 11\n      }\n    }, __jsx(\"div\", {\n      style: {\n        overflow: 'hidden',\n        paddingTop: 4\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 13\n      }\n    }, __jsx(_Button, {\n      type: \"primary\",\n      htmlType: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 15\n      }\n    }, \"\\u67E5\\u8BE2\"), __jsx(_Button, {\n      style: {\n        marginLeft: 8\n      },\n      onClick: this.onResetFormClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 15\n      }\n    }, \"\\u91CD\\u7F6E\")))));\n  }\n\n  render() {\n    const {\n      loading,\n      user: {\n        data: {\n          list,\n          pagination\n        }\n      }\n    } = this.props;\n    const {\n      selectedRows,\n      selectedRowKeys\n    } = this.state;\n    const columns = [{\n      title: '用户名',\n      dataIndex: 'user_name'\n    }, {\n      title: '真实姓名',\n      dataIndex: 'real_name'\n    }, {\n      title: '角色名称',\n      dataIndex: 'roles',\n      render: val => {\n        if (!val || val.length === 0) {\n          return __jsx(\"span\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 20\n            }\n          }, \"-\");\n        }\n\n        const names = [];\n\n        for (let i = 0; i < val.length; i += 1) {\n          names.push(val[i].name);\n        }\n\n        return __jsx(\"span\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 236,\n            columnNumber: 18\n          }\n        }, names.join(' | '));\n      }\n    }, {\n      title: '用户状态',\n      dataIndex: 'status',\n      render: val => {\n        if (val === 1) {\n          return __jsx(_Badge, {\n            status: \"success\",\n            text: \"\\u542F\\u7528\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 20\n            }\n          });\n        }\n\n        return __jsx(_Badge, {\n          status: \"error\",\n          text: \"\\u505C\\u7528\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 246,\n            columnNumber: 18\n          }\n        });\n      }\n    }, {\n      title: '邮箱',\n      dataIndex: 'email'\n    }, {\n      title: '手机号',\n      dataIndex: 'phone'\n    }, {\n      title: '创建时间',\n      dataIndex: 'created_at',\n      render: val => __jsx(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 24\n        }\n      }, formatDate(val, 'YYYY-MM-DD HH:mm'))\n    }];\n\n    const paginationProps = _objectSpread({\n      showSizeChanger: true,\n      showQuickJumper: true,\n      showTotal: total => __jsx(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 27\n        }\n      }, \"\\u5171\", total, \"\\u6761\")\n    }, pagination);\n\n    return __jsx(PageHeaderLayout, {\n      title: \"\\u7528\\u6237\\u7BA1\\u7406\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 7\n      }\n    }, __jsx(_Card, {\n      bordered: false,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 9\n      }\n    }, __jsx(\"div\", {\n      className: styles.tableList,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 11\n      }\n    }, __jsx(\"div\", {\n      className: styles.tableListForm,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 13\n      }\n    }, this.renderSearchForm()), __jsx(\"div\", {\n      className: styles.tableListOperator,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 13\n      }\n    }, __jsx(PButton, {\n      code: \"add\",\n      type: \"primary\",\n      onClick: () => this.onAddClick(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 15\n      }\n    }, \"\\u65B0\\u5EFA\"), selectedRows.length === 1 && [__jsx(PButton, {\n      key: \"edit\",\n      code: \"edit\",\n      onClick: () => this.onItemEditClick(selectedRows[0]),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281,\n        columnNumber: 17\n      }\n    }, \"\\u7F16\\u8F91\"), __jsx(PButton, {\n      key: \"del\",\n      code: \"del\",\n      type: \"danger\",\n      onClick: () => this.onItemDelClick(selectedRows[0]),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 17\n      }\n    }, \"\\u5220\\u9664\"), selectedRows[0].status === 2 && __jsx(PButton, {\n      key: \"enable\",\n      code: \"enable\",\n      onClick: () => this.onItemEnableClick(selectedRows[0]),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 19\n      }\n    }, \"\\u542F\\u7528\"), selectedRows[0].status === 1 && __jsx(PButton, {\n      key: \"disable\",\n      code: \"disable\",\n      type: \"danger\",\n      onClick: () => this.onItemDisableClick(selectedRows[0]),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 19\n      }\n    }, \"\\u7981\\u7528\")]), __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 13\n      }\n    }, __jsx(_Table, {\n      rowSelection: {\n        selectedRowKeys,\n        onSelect: this.handleTableSelectRow\n      },\n      loading: loading,\n      rowKey: record => record.id,\n      dataSource: list,\n      columns: columns,\n      pagination: paginationProps,\n      onChange: this.onTableChange,\n      size: \"small\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 15\n      }\n    })))), this.renderDataForm());\n  }\n\n}, _temp)) || _class);\nexport default WithDva(state => ({\n  loading: state.loading.models.user,\n  user: state.user\n}))(UserList); // export default UserList;","map":{"version":3,"sources":["/Users/nguyenthanhbinh/Work/vnshop/admin/src/pages/user/UserList.js"],"names":["React","PureComponent","Form","PButton","PageHeaderLayout","UserCard","RoleSelect","formatDate","styles","WithDva","UserList","create","selectedRowKeys","selectedRows","item","dispatch","type","payload","id","status","state","length","setState","confirm","title","user_name","okText","okType","cancelText","onOk","onDelOKClick","bind","record","selected","keys","rows","push","pagination","current","pageSize","clearSelectRows","form","props","resetFields","search","e","preventDefault","validateFields","force","err","values","formData","roleIDs","map","v","role_id","join","data","action","componentDidMount","renderDataForm","onDataFormCancel","onDataFormSubmit","renderSearchForm","getFieldDecorator","onSearchFormSubmit","overflow","paddingTop","marginLeft","onResetFormClick","render","loading","user","list","columns","dataIndex","val","names","i","name","paginationProps","showSizeChanger","showQuickJumper","showTotal","total","tableList","tableListForm","tableListOperator","onAddClick","onItemEditClick","onItemDelClick","onItemEnableClick","onItemDisableClick","onSelect","handleTableSelectRow","onTableChange","models"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react';\r\n\r\nimport { Form } from '@ant-design/compatible';\r\nimport '@ant-design/compatible/assets/index.css';\r\nimport { Row, Col, Card, Input, Button, Table, Modal, Badge } from 'antd';\r\nimport PButton from '@/components/PermButton';\r\nimport PageHeaderLayout from '../../layouts/PageHeaderLayout';\r\nimport UserCard from './UserCard';\r\nimport RoleSelect from './RoleSelect';\r\nimport { formatDate } from '../../utils/utils';\r\n\r\nimport styles from './UserList.less';\r\nimport WithDva from '../../utils/store';\r\n\r\n\r\n// @connect(state => ({\r\n//   loading: state.loading.models.user,\r\n//   user: state.user,\r\n// }))\r\n\r\n\r\n@Form.create()\r\nclass UserList extends PureComponent {\r\n  state = {\r\n    selectedRowKeys: [],\r\n    selectedRows: [],\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.dispatch({\r\n      type: 'user/fetch',\r\n      search: {},\r\n      pagination: {},\r\n    });\r\n  }\r\n\r\n  onItemDisableClick = item => {\r\n    this.dispatch({\r\n      type: 'user/changeStatus',\r\n      payload: { id: item.id, status: 2 },\r\n    });\r\n  };\r\n\r\n  onItemEnableClick = item => {\r\n    this.dispatch({\r\n      type: 'user/changeStatus',\r\n      payload: { id: item.id, status: 1 },\r\n    });\r\n  };\r\n\r\n  onItemEditClick = item => {\r\n    this.dispatch({\r\n      type: 'user/loadForm',\r\n      payload: {\r\n        type: 'E',\r\n        id: item.id,\r\n      },\r\n    });\r\n  };\r\n\r\n  onAddClick = () => {\r\n    this.dispatch({\r\n      type: 'user/loadForm',\r\n      payload: {\r\n        type: 'A',\r\n      },\r\n    });\r\n  };\r\n\r\n  onDelOKClick(id) {\r\n    this.dispatch({\r\n      type: 'user/del',\r\n      payload: { id },\r\n    });\r\n    this.clearSelectRows();\r\n  }\r\n\r\n  clearSelectRows = () => {\r\n    const { selectedRowKeys } = this.state;\r\n    if (selectedRowKeys.length === 0) {\r\n      return;\r\n    }\r\n    this.setState({ selectedRowKeys: [], selectedRows: [] });\r\n  };\r\n\r\n  onItemDelClick = item => {\r\n    Modal.confirm({\r\n      title: `确定删除【用户数据：${item.user_name}】？`,\r\n      okText: '确认',\r\n      okType: 'danger',\r\n      cancelText: '取消',\r\n      onOk: this.onDelOKClick.bind(this, item.id),\r\n    });\r\n  };\r\n\r\n  handleTableSelectRow = (record, selected) => {\r\n    const keys = [];\r\n    const rows = [];\r\n    if (selected) {\r\n      keys.push(record.id);\r\n      rows.push(record);\r\n    }\r\n    this.setState({\r\n      selectedRowKeys: keys,\r\n      selectedRows: rows,\r\n    });\r\n  };\r\n\r\n  onTableChange = pagination => {\r\n    this.dispatch({\r\n      type: 'user/fetch',\r\n      pagination: {\r\n        current: pagination.current,\r\n        pageSize: pagination.pageSize,\r\n      },\r\n    });\r\n    this.clearSelectRows();\r\n  };\r\n\r\n  onResetFormClick = () => {\r\n    const { form } = this.props;\r\n    form.resetFields();\r\n    this.dispatch({\r\n      type: 'user/fetch',\r\n      search: {},\r\n      pagination: {},\r\n    });\r\n  };\r\n\r\n  onSearchFormSubmit = e => {\r\n    if (e) {\r\n      e.preventDefault();\r\n    }\r\n    const { form } = this.props;\r\n    form.validateFields({ force: true }, (err, values) => {\r\n      if (err) {\r\n        return;\r\n      }\r\n\r\n      const formData = { ...values };\r\n      if (formData.roleIDs) {\r\n        formData.roleIDs = formData.roleIDs.map(v => v.role_id).join(',');\r\n      }\r\n      this.dispatch({\r\n        type: 'user/fetch',\r\n        search: formData,\r\n        pagination: {},\r\n      });\r\n      this.clearSelectRows();\r\n    });\r\n  };\r\n\r\n  onDataFormSubmit = data => {\r\n    this.dispatch({\r\n      type: 'user/submit',\r\n      payload: data,\r\n    });\r\n    this.clearSelectRows();\r\n  };\r\n\r\n  onDataFormCancel = () => {\r\n    this.dispatch({\r\n      type: 'user/changeFormVisible',\r\n      payload: false,\r\n    });\r\n  };\r\n\r\n  dispatch = action => {\r\n    const { dispatch } = this.props;\r\n    dispatch(action);\r\n  };\r\n\r\n  renderDataForm() {\r\n    return <UserCard onCancel={this.onDataFormCancel} onSubmit={this.onDataFormSubmit} />;\r\n  }\r\n\r\n  renderSearchForm() {\r\n    const {\r\n      form: { getFieldDecorator },\r\n    } = this.props;\r\n    return (\r\n      <Form onSubmit={this.onSearchFormSubmit}>\r\n        <Row gutter={16}>\r\n          <Col span={8}>\r\n            <Form.Item label=\"模糊查询\">\r\n              {getFieldDecorator('queryValue')(<Input placeholder=\"请输入需要查询的内容\" />)}\r\n            </Form.Item>\r\n          </Col>\r\n          <Col span={8}>\r\n            <Form.Item label=\"所属角色\">{getFieldDecorator('roleIDs')(<RoleSelect />)}</Form.Item>\r\n          </Col>\r\n          <Col span={8}>\r\n            <div style={{ overflow: 'hidden', paddingTop: 4 }}>\r\n              <Button type=\"primary\" htmlType=\"submit\">\r\n                查询\r\n              </Button>\r\n              <Button style={{ marginLeft: 8 }} onClick={this.onResetFormClick}>\r\n                重置\r\n              </Button>\r\n            </div>\r\n          </Col>\r\n        </Row>\r\n      </Form>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      loading,\r\n      user: {\r\n        data: { list, pagination },\r\n      },\r\n    } = this.props;\r\n\r\n    const { selectedRows, selectedRowKeys } = this.state;\r\n    const columns = [\r\n      {\r\n        title: '用户名',\r\n        dataIndex: 'user_name',\r\n      },\r\n      {\r\n        title: '真实姓名',\r\n        dataIndex: 'real_name',\r\n      },\r\n      {\r\n        title: '角色名称',\r\n        dataIndex: 'roles',\r\n        render: val => {\r\n          if (!val || val.length === 0) {\r\n            return <span>-</span>;\r\n          }\r\n          const names = [];\r\n          for (let i = 0; i < val.length; i += 1) {\r\n            names.push(val[i].name);\r\n          }\r\n          return <span>{names.join(' | ')}</span>;\r\n        },\r\n      },\r\n      {\r\n        title: '用户状态',\r\n        dataIndex: 'status',\r\n        render: val => {\r\n          if (val === 1) {\r\n            return <Badge status=\"success\" text=\"启用\" />;\r\n          }\r\n          return <Badge status=\"error\" text=\"停用\" />;\r\n        },\r\n      },\r\n      {\r\n        title: '邮箱',\r\n        dataIndex: 'email',\r\n      },\r\n      {\r\n        title: '手机号',\r\n        dataIndex: 'phone',\r\n      },\r\n      {\r\n        title: '创建时间',\r\n        dataIndex: 'created_at',\r\n        render: val => <span>{formatDate(val, 'YYYY-MM-DD HH:mm')}</span>,\r\n      },\r\n    ];\r\n\r\n    const paginationProps = {\r\n      showSizeChanger: true,\r\n      showQuickJumper: true,\r\n      showTotal: total => <span>共{total}条</span>,\r\n      ...pagination,\r\n    };\r\n\r\n    return (\r\n      <PageHeaderLayout title=\"用户管理\">\r\n        <Card bordered={false}>\r\n          <div className={styles.tableList}>\r\n            <div className={styles.tableListForm}>{this.renderSearchForm()}</div>\r\n            <div className={styles.tableListOperator}>\r\n              <PButton code=\"add\" type=\"primary\" onClick={() => this.onAddClick()}>\r\n                新建\r\n              </PButton>\r\n              {selectedRows.length === 1 && [\r\n                <PButton\r\n                  key=\"edit\"\r\n                  code=\"edit\"\r\n                  onClick={() => this.onItemEditClick(selectedRows[0])}\r\n                >\r\n                  编辑\r\n                </PButton>,\r\n                <PButton\r\n                  key=\"del\"\r\n                  code=\"del\"\r\n                  type=\"danger\"\r\n                  onClick={() => this.onItemDelClick(selectedRows[0])}\r\n                >\r\n                  删除\r\n                </PButton>,\r\n                selectedRows[0].status === 2 && (\r\n                  <PButton\r\n                    key=\"enable\"\r\n                    code=\"enable\"\r\n                    onClick={() => this.onItemEnableClick(selectedRows[0])}\r\n                  >\r\n                    启用\r\n                  </PButton>\r\n                ),\r\n                selectedRows[0].status === 1 && (\r\n                  <PButton\r\n                    key=\"disable\"\r\n                    code=\"disable\"\r\n                    type=\"danger\"\r\n                    onClick={() => this.onItemDisableClick(selectedRows[0])}\r\n                  >\r\n                    禁用\r\n                  </PButton>\r\n                ),\r\n              ]}\r\n            </div>\r\n            <div>\r\n              <Table\r\n                rowSelection={{\r\n                  selectedRowKeys,\r\n                  onSelect: this.handleTableSelectRow,\r\n                }}\r\n                loading={loading}\r\n                rowKey={record => record.id}\r\n                dataSource={list}\r\n                columns={columns}\r\n                pagination={paginationProps}\r\n                onChange={this.onTableChange}\r\n                size=\"small\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </Card>\r\n        {this.renderDataForm()}\r\n      </PageHeaderLayout>\r\n    );\r\n  }\r\n}\r\nexport default WithDva(state => ({\r\n  loading: state.loading.models.user,\r\n  user: state.user,\r\n}))(UserList);\r\n// export default UserList;\r\n"]},"metadata":{},"sourceType":"module"}