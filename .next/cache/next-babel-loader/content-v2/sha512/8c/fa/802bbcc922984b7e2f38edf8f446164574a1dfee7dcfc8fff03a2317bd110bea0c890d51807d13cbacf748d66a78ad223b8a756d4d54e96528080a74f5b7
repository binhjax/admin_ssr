{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { PortModel } from '@projectstorm/react-diagrams';\nimport { CustomLinkModel } from './CustomLinkModel';\nimport v4 from 'uuid';\nexport class CustomPortModel extends PortModel {\n  constructor(name, type, key) {\n    super({\n      type: 'custom',\n      name: v4(),\n      extras: {\n        name: name,\n        type: type,\n        key: key\n      }\n    });\n  }\n\n  link(target) {\n    let link = new CustomLinkModel();\n    this.reportPosition();\n    target.reportPosition();\n    link.setSourcePort(this);\n    link.setTargetPort(target);\n    return link;\n  }\n\n  createLinkModel() {\n    return new CustomLinkModel();\n  }\n\n  deserialize(event) {\n    super.deserialize(event);\n    this.reportedPosition = false;\n    this.options.name = event.data.name;\n    this.options.alignment = event.data.alignment;\n  }\n\n  serialize() {\n    return _objectSpread(_objectSpread({}, super.serialize()), {}, {\n      name: this.options.name,\n      alignment: this.options.alignment,\n      parentNode: this.parent.getID(),\n      links: _.map(this.links, link => {\n        return link.getID();\n      })\n    });\n  }\n\n  setPosition(x, y) {\n    let old = this.position;\n    super.setPosition(x, y);\n\n    _.forEach(this.getLinks(), link => {\n      let point = link.getPointForPort(this);\n      point.setPosition(point.getX() + x - old.x, point.getY() + y - old.y);\n    });\n  }\n\n  doClone(lookupTable = {}, clone) {\n    clone.links = {};\n    clone.parentNode = this.getParent().clone(lookupTable);\n  }\n\n  getNode() {\n    return this.getParent();\n  }\n\n  getName() {\n    return this.options.name;\n  }\n\n  getMaximumLinks() {\n    return this.options.maximumLinks;\n  }\n\n  setMaximumLinks(maximumLinks) {\n    this.options.maximumLinks = maximumLinks;\n  }\n\n  removeLink(link) {\n    delete this.links[link.getID()];\n  }\n\n  addLink(link) {\n    this.links[link.getID()] = link;\n  }\n\n  getLinks() {\n    return this.links;\n  }\n\n  createLinkModel() {\n    if (_.isFinite(this.options.maximumLinks)) {\n      var numberOfLinks = _.size(this.links);\n\n      if (this.options.maximumLinks === 1 && numberOfLinks >= 1) {\n        return _.values(this.links)[0];\n      } else if (numberOfLinks >= this.options.maximumLinks) {\n        return null;\n      }\n    }\n\n    return null;\n  }\n\n  reportPosition() {\n    _.forEach(this.getLinks(), link => {\n      link.getPointForPort(this).setPosition(this.getCenter());\n    });\n\n    this.fireEvent({\n      entity: this\n    }, 'reportInitialPosition');\n  }\n\n  getCenter() {\n    return new Point(this.getX() + this.width / 2, this.getY() + this.height / 2);\n  }\n\n  updateCoords(coords) {\n    this.width = coords.getWidth();\n    this.height = coords.getHeight();\n    this.setPosition(coords.getTopLeft());\n    this.reportedPosition = true;\n    this.reportPosition();\n  }\n\n  canLinkToPort(port) {\n    return true;\n  }\n\n  isLocked() {\n    return super.isLocked() || this.getParent().isLocked();\n  }\n\n}","map":{"version":3,"sources":["/home/tuanquang/admin_ssr/src/components/Test/CustomPortModel.ts"],"names":["PortModel","CustomLinkModel","v4","CustomPortModel","constructor","name","type","key","extras","link","target","reportPosition","setSourcePort","setTargetPort","createLinkModel","deserialize","event","reportedPosition","options","data","alignment","serialize","parentNode","parent","getID","links","_","map","setPosition","x","y","old","position","forEach","getLinks","point","getPointForPort","getX","getY","doClone","lookupTable","clone","getParent","getNode","getName","getMaximumLinks","maximumLinks","setMaximumLinks","removeLink","addLink","isFinite","numberOfLinks","size","values","getCenter","fireEvent","entity","Point","width","height","updateCoords","coords","getWidth","getHeight","getTopLeft","canLinkToPort","port","isLocked"],"mappings":"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","sourcesContent":["import { PortModel } from '@projectstorm/react-diagrams';\nimport { CustomLinkModel } from './CustomLinkModel';\nimport v4 from 'uuid';\nexport class CustomPortModel extends PortModel {\n  constructor(name: string, type: string, key: string) {\n    super({\n      type: 'custom',\n      name: v4(),\n      extras: { name: name, type: type, key: key},\n    });\n\n  }\n  link(target: CustomPortModel) {\n    let link = new CustomLinkModel();\n    this.reportPosition();\n    target.reportPosition();\n    link.setSourcePort(this);\n    link.setTargetPort(target);\n\n    return link;\n  }\n  createLinkModel() {\n    return new CustomLinkModel();\n  }\n  deserialize(event: DeserializeEvent<this>) {\n\t\tsuper.deserialize(event);\n\t\tthis.reportedPosition = false;\n\t\tthis.options.name = event.data.name;\n\t\tthis.options.alignment = event.data.alignment;\n\t}\n\n\tserialize() {\n\t\treturn {\n\t\t\t...super.serialize(),\n\t\t\tname: this.options.name,\n\t\t\talignment: this.options.alignment,\n\t\t\tparentNode: this.parent.getID(),\n\t\t\tlinks: _.map(this.links, (link) => {\n\t\t\t\treturn link.getID();\n\t\t\t})\n\t\t};\n\t}\n\n\tsetPosition(point: Point);\n\tsetPosition(x: number, y: number);\n\tsetPosition(x, y?) {\n\t\tlet old = this.position;\n\t\tsuper.setPosition(x, y);\n\t\t_.forEach(this.getLinks(), (link) => {\n\t\t\tlet point = link.getPointForPort(this);\n\t\t\tpoint.setPosition(point.getX() + x - old.x, point.getY() + y - old.y);\n\t\t});\n\t}\n\n\tdoClone(lookupTable = {}, clone) {\n\t\tclone.links = {};\n\t\tclone.parentNode = this.getParent().clone(lookupTable);\n\t}\n\n\tgetNode(): NodeModel {\n\t\treturn this.getParent();\n\t}\n\n\tgetName(): string {\n\t\treturn this.options.name;\n\t}\n\n\tgetMaximumLinks(): number {\n\t\treturn this.options.maximumLinks;\n\t}\n\n\tsetMaximumLinks(maximumLinks: number) {\n\t\tthis.options.maximumLinks = maximumLinks;\n\t}\n\n\tremoveLink(link: LinkModel) {\n\t\tdelete this.links[link.getID()];\n\t}\n\n\taddLink(link: LinkModel) {\n\t\tthis.links[link.getID()] = link;\n\t}\n\n\tgetLinks(): { [id: string]: LinkModel } {\n\t\treturn this.links;\n\t}\n\n\tpublic createLinkModel(): LinkModel | null {\n\t\tif (_.isFinite(this.options.maximumLinks)) {\n\t\t\tvar numberOfLinks: number = _.size(this.links);\n\t\t\tif (this.options.maximumLinks === 1 && numberOfLinks >= 1) {\n\t\t\t\treturn _.values(this.links)[0];\n\t\t\t} else if (numberOfLinks >= this.options.maximumLinks) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\treportPosition() {\n\t\t_.forEach(this.getLinks(), (link) => {\n\t\t\tlink.getPointForPort(this).setPosition(this.getCenter());\n\t\t});\n\t\tthis.fireEvent(\n\t\t\t{\n\t\t\t\tentity: this\n\t\t\t},\n\t\t\t'reportInitialPosition'\n\t\t);\n\t}\n\n\tgetCenter(): Point {\n\t\treturn new Point(this.getX() + this.width / 2, this.getY() + this.height / 2);\n\t}\n\n\tupdateCoords(coords: Rectangle) {\n\t\tthis.width = coords.getWidth();\n\t\tthis.height = coords.getHeight();\n\t\tthis.setPosition(coords.getTopLeft());\n\t\tthis.reportedPosition = true;\n\t\tthis.reportPosition();\n\t}\n\n\tcanLinkToPort(port: PortModel): boolean {\n\t\treturn true;\n\t}\n\n\tisLocked() {\n\t\treturn super.isLocked() || this.getParent().isLocked();\n\t}\n\n}\n"]},"metadata":{},"sourceType":"module"}