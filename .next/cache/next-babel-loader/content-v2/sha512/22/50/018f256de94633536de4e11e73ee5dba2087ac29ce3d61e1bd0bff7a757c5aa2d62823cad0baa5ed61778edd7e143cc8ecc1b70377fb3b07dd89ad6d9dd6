{"ast":null,"code":"import \"antd/lib/popover/style\";\nimport _Popover from \"antd/lib/popover\";\nimport \"antd/lib/auto-complete/style\";\nimport _AutoComplete from \"antd/lib/auto-complete\";\nimport \"antd/lib/col/style\";\nimport _Col from \"antd/lib/col\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nimport \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport \"antd/lib/select/style\";\nimport _Select from \"antd/lib/select\";\nimport \"antd/lib/typography/style\";\nimport _Typography from \"antd/lib/typography\";\nvar _jsxFileName = \"/home/tuanquang/admin_ssr/src/components/CustomNode/CustomNodeWidget.tsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport * as React from 'react';\nimport { useDispatch, useSelector } from 'react-redux'; // import * as action from '../../actions/node';\n\nimport { PortWidget } from '@projectstorm/react-diagrams';\nimport styled from '@emotion/styled';\nimport { TYPE } from '../../const';\nimport { ExclamationCircleOutlined, PlusOutlined, EditOutlined, KeyOutlined, MoreOutlined, DeleteOutlined } from '@ant-design/icons';\nconst {\n  Text\n} = _Typography;\nconst {\n  Option\n} = _Select;\n\n/**\n * @author Nguyen Tuan Quang\n */\nexport const Port = styled.div`\n  width: 20px;\n  height: 20px;\n  background: #f6f6f6;\n  cursor: pointer;\n  margin-top: 5px;\n\n  &:hover {\n    background: #deecf3;\n  }\n`;\nconst styles = {\n  cardHeader: {\n    color: 'white',\n    border: ' 0 solid #e2e8f0',\n    fontWeight: 400,\n    fontSize: '20px',\n    padding: '5px 20px',\n    height: '40px',\n    background: '#316896',\n    marginBottom: '-2px'\n  },\n  rightPort: {\n    width: '20px',\n    height: '20px',\n    position: 'absolute',\n    left: '380px'\n  },\n  leftPort: {\n    width: '20px',\n    height: '20px',\n    position: 'absolute',\n    left: '0'\n  },\n  fieldText: {\n    fontSize: '20px'\n  }\n};\n\nconst CustomNodeWidget = props => {\n  // const { dispatch } = props;\n  const [editNode, setEditNode] = React.useState(false);\n  const [name, setName] = React.useState('');\n  const [hover, setHover] = React.useState('');\n  const ports = useSelector(state => state.node.ports);\n  const dispatch = useDispatch();\n\n  const save = () => {\n    props.node.addCustomPort('new_col', '', '');\n    props.engine.repaintCanvas();\n  };\n\n  const confirm = () => {\n    _Modal.confirm({\n      title: 'Confirm',\n      icon: __jsx(ExclamationCircleOutlined, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 13\n        }\n      }),\n      content: 'Confirm delete table',\n      okText: 'Yes',\n      cancelText: 'No',\n\n      onOk() {\n        props.node.remove();\n        props.engine.repaintCanvas();\n      }\n\n    });\n  };\n\n  const confirmDeletePort = port => {\n    _Modal.confirm({\n      title: 'Confirm',\n      icon: __jsx(ExclamationCircleOutlined, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 13\n        }\n      }),\n      content: 'Confirm delete port',\n      okText: 'Yes',\n      cancelText: 'No',\n\n      onOk() {\n        props.node.removePort(port);\n        dispatch(action.setPorts(props.node.getPorts()));\n        props.engine.repaintCanvas();\n      }\n\n    });\n  };\n\n  const openEdit = () => {\n    setEditNode(true);\n    setName(props.node.getOptions().extras);\n    dispatch(action.setPorts(props.node.getPorts()));\n  };\n\n  const closeEdit = () => {\n    setEditNode(false);\n    setName('');\n  };\n\n  const handelChangeName = e => {\n    setName(e.target.value);\n  };\n\n  const handleChangePort = e => {\n    const {\n      id,\n      name,\n      value\n    } = e.target;\n    ports[name].getOptions().extras[id] = value; // dispatch(action.setPorts({ ...ports }));\n  };\n\n  const submit = () => {\n    props.node.setName(name);\n    closeEdit();\n  };\n\n  const handleDeleteButton = (e, value) => {\n    e.stopPropagation();\n\n    if (e.key === 'Delete') {\n      confirmDeletePort(value);\n    }\n  };\n\n  const handleRowClick = (e, key, value) => {\n    setHover(key); // dispatch(action.setPort(value));\n\n    props.node.setSelected(false);\n  };\n\n  const selectTable = e => {\n    props.node.setSelected(false); // dispatch(action.setSelectedNode(props.node));\n    // dispatch(action.setActive('table'));\n  };\n\n  const content = __jsx(_Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 5\n    }\n  }, __jsx(_Button, {\n    type: \"ghost\",\n    icon: __jsx(PlusOutlined, {\n      style: {\n        color: 'green'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 15\n      }\n    }),\n    onClick: () => save(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }\n  }), __jsx(_Button, {\n    type: \"ghost\",\n    icon: __jsx(EditOutlined, {\n      style: {\n        color: 'cyan'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 15\n      }\n    }),\n    onClick: () => openEdit(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 7\n    }\n  }), __jsx(_Button, {\n    type: \"ghost\",\n    icon: __jsx(DeleteOutlined, {\n      style: {\n        color: 'red'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 15\n      }\n    }),\n    onClick: () => confirm(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 7\n    }\n  }));\n\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 5\n    }\n  }, __jsx(_Modal, {\n    visible: editNode,\n    onCancel: () => closeEdit(),\n    okText: \"Save\",\n    cancelText: \"Cancel\",\n    onOk: () => submit(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 7\n    }\n  }, \"Name:\", __jsx(_Input, {\n    value: name,\n    name: \"name\",\n    key: \"name\",\n    onChange: handelChangeName,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 9\n    }\n  }), \"Body:\", ports !== undefined ? Object.entries(ports).map(([key, value], index) => value.getOptions().extras.key === 'PRIMARY KEY' ? __jsx(_Row, {\n    gutter: 16,\n    key: index,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 17\n    }\n  }, __jsx(_Col, {\n    span: \"10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 19\n    }\n  }, __jsx(_Input, {\n    id: \"name\",\n    value: value.getOptions().extras.name,\n    name: key,\n    key: index,\n    onChange: handleChangePort,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 21\n    }\n  })), __jsx(_Col, {\n    span: \"8\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 19\n    }\n  }, __jsx(_AutoComplete, {\n    style: {\n      width: 150\n    },\n    options: TYPE,\n    filterOption: (inputValue, option) => option.value.toUpperCase().indexOf(inputValue.toUpperCase()) !== -1,\n    value: value.getOptions().extras.type,\n    onChange: type => {\n      value.getOptions().extras.type = type;\n      dispatch(action.setPorts(_objectSpread({}, ports)));\n    },\n    onSelect: type => {\n      value.getOptions().extras.type = type;\n      dispatch(action.setPorts(_objectSpread({}, ports)));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 21\n    }\n  })), __jsx(_Col, {\n    span: \"6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 19\n    }\n  }, __jsx(_Select, {\n    defaultValue: value.getOptions().extras.key,\n    style: {\n      width: 120\n    },\n    onChange: key => {\n      value.getOptions().extras.key = key;\n      dispatch(action.setPorts(_objectSpread({}, ports)));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 21\n    }\n  }, __jsx(Option, {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 23\n    }\n  }, \"null\"), __jsx(Option, {\n    value: \"PRIMARY KEY\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 23\n    }\n  }, \"PRIMARY KEY\")))) : '') : '', __jsx(\"hr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 9\n    }\n  }), ports !== undefined ? Object.entries(ports).map(([key, value], index) => value.getOptions().extras.key !== 'PRIMARY KEY' ? __jsx(_Row, {\n    gutter: 16,\n    key: index,\n    style: {\n      paddingTop: '5px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 17\n    }\n  }, __jsx(_Col, {\n    span: \"10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 19\n    }\n  }, __jsx(_Input, {\n    id: \"name\",\n    value: value.getOptions().extras.name,\n    name: key,\n    key: index,\n    onChange: handleChangePort,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 21\n    }\n  })), __jsx(_Col, {\n    span: \"8\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 19\n    }\n  }, __jsx(_AutoComplete, {\n    style: {\n      width: 150\n    },\n    options: TYPE,\n    filterOption: (inputValue, option) => option.value.toUpperCase().indexOf(inputValue.toUpperCase()) !== -1,\n    value: value.getOptions().extras.type,\n    onChange: type => {\n      value.getOptions().extras.type = type;\n      dispatch(action.setPorts(_objectSpread({}, ports)));\n    },\n    onSelect: type => {\n      value.getOptions().extras.type = type;\n      dispatch(action.setPorts(_objectSpread({}, ports)));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 21\n    }\n  })), __jsx(_Col, {\n    span: \"6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 19\n    }\n  }, __jsx(_Select, {\n    defaultValue: value.getOptions().extras.key,\n    style: {\n      width: 120\n    },\n    onChange: key => {\n      value.getOptions().extras.key = key;\n      dispatch(action.setPorts(_objectSpread({}, ports)));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 21\n    }\n  }, __jsx(Option, {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 23\n    }\n  }, \"null\"), __jsx(Option, {\n    value: \"PRIMARY KEY\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 23\n    }\n  }, \"PRIMARY KEY\")))) : '') : ''), __jsx(\"div\", {\n    className: 'custom-node',\n    style: {\n      position: 'relative',\n      minWidth: props.size * 4,\n      minHeight: props.size\n    },\n    onKeyDown: e => {\n      e.stopPropagation();\n\n      if (e.key === 'Delete') {\n        confirm();\n      }\n    },\n    onClick: e => {\n      selectTable(e);\n    },\n    tabIndex: -1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    style: styles.cardHeader,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 9\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 11\n    }\n  }, props.node.getOptions().extras)), __jsx(\"div\", {\n    style: {\n      background: '#F6F6F6',\n      padding: '20px',\n      border: 'none'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    style: {\n      position: 'absolute',\n      top: '0',\n      right: '0'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 11\n    }\n  }, __jsx(_Popover, {\n    placement: \"rightBottom\",\n    content: content,\n    trigger: \"focus\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 13\n    }\n  }, __jsx(_Button, {\n    type: \"ghost\",\n    style: {\n      border: 'none'\n    },\n    icon: __jsx(MoreOutlined, {\n      style: {\n        color: 'white',\n        fontSize: '20px',\n        paddingTop: '5px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312,\n        columnNumber: 19\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 15\n    }\n  }))), Object.entries(props.node.getPorts()).map(([key, value], index) => value.getOptions().extras.key === 'PRIMARY KEY' ? __jsx(_Row, {\n    key: index,\n    onFocus: () => setHover(key),\n    onBlur: () => setHover(''),\n    style: {\n      backgroundColor: hover === key ? '#4770FF' : '',\n      fontWeight: 'bold',\n      fontSize: '20px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 15\n    }\n  }, __jsx(PortWidget, {\n    port: value,\n    engine: props.engine,\n    style: styles.leftPort,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 17\n    }\n  }, __jsx(Port, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 19\n    }\n  })), __jsx(PortWidget, {\n    port: value,\n    engine: props.engine,\n    style: styles.rightPort,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 332,\n      columnNumber: 17\n    }\n  }, __jsx(Port, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 19\n    }\n  })), __jsx(_Col, {\n    span: 10,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 335,\n      columnNumber: 17\n    }\n  }, __jsx(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 19\n    }\n  }, value.getOptions().extras.name)), __jsx(_Col, {\n    span: 8,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 338,\n      columnNumber: 17\n    }\n  }, __jsx(Text, {\n    style: {\n      color: '#dbdd4d'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 339,\n      columnNumber: 19\n    }\n  }, value.getOptions().extras.type)), __jsx(_Col, {\n    span: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 17\n    }\n  }, __jsx(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 19\n    }\n  }, \"PK\")), __jsx(_Col, {\n    span: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 344,\n      columnNumber: 17\n    }\n  }, __jsx(KeyOutlined, {\n    style: {\n      color: 'yellow',\n      fontSize: 20\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 19\n    }\n  }))) : ''), __jsx(\"hr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 11\n    }\n  }), Object.entries(props.node.getPorts()).map(([key, value], index) => value.getOptions().extras.key !== 'PRIMARY KEY' ? __jsx(_Row, {\n    key: index,\n    onClick: e => handleRowClick(e, key, value),\n    onBlur: () => setHover(''),\n    style: {\n      backgroundColor: hover === key ? '#deecf3' : ''\n    },\n    onKeyDown: e => handleDeleteButton(e, value),\n    tabIndex: -1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 356,\n      columnNumber: 15\n    }\n  }, __jsx(PortWidget, {\n    port: value,\n    engine: props.engine,\n    style: styles.leftPort,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 364,\n      columnNumber: 17\n    }\n  }, __jsx(Port, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 365,\n      columnNumber: 19\n    }\n  })), __jsx(PortWidget, {\n    port: value,\n    engine: props.engine,\n    style: styles.rightPort,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 367,\n      columnNumber: 17\n    }\n  }, __jsx(Port, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 368,\n      columnNumber: 19\n    }\n  })), __jsx(_Col, {\n    lg: 10,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 370,\n      columnNumber: 17\n    }\n  }, __jsx(Text, {\n    style: styles.fieldText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 19\n    }\n  }, value.getOptions().extras.name)), __jsx(_Col, {\n    lg: 8,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 373,\n      columnNumber: 17\n    }\n  }, __jsx(Text, {\n    style: styles.fieldText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 19\n    }\n  }, value.getOptions().extras.type)), __jsx(_Col, {\n    lg: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 17\n    }\n  }, __jsx(Text, {\n    style: styles.fieldText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 377,\n      columnNumber: 19\n    }\n  }, value.getOptions().extras.key))) : ''))));\n};\n\nexport default CustomNodeWidget;","map":{"version":3,"sources":["/home/tuanquang/admin_ssr/src/components/CustomNode/CustomNodeWidget.tsx"],"names":["React","useDispatch","useSelector","PortWidget","styled","TYPE","ExclamationCircleOutlined","PlusOutlined","EditOutlined","KeyOutlined","MoreOutlined","DeleteOutlined","Text","Option","Port","div","styles","cardHeader","color","border","fontWeight","fontSize","padding","height","background","marginBottom","rightPort","width","position","left","leftPort","fieldText","CustomNodeWidget","props","editNode","setEditNode","useState","name","setName","hover","setHover","ports","state","node","dispatch","save","addCustomPort","engine","repaintCanvas","confirm","title","icon","content","okText","cancelText","onOk","remove","confirmDeletePort","port","removePort","action","setPorts","getPorts","openEdit","getOptions","extras","closeEdit","handelChangeName","e","target","value","handleChangePort","id","submit","handleDeleteButton","stopPropagation","key","handleRowClick","setSelected","selectTable","undefined","Object","entries","map","index","inputValue","option","toUpperCase","indexOf","type","paddingTop","minWidth","size","minHeight","top","right","backgroundColor"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { CustomNodeModel } from './CustomNodeModel';\nimport { useDispatch, useSelector } from 'react-redux';\n// import * as action from '../../actions/node';\nimport { DiagramEngine, PortWidget, PortModel } from '@projectstorm/react-diagrams';\nimport styled from '@emotion/styled';\nimport { TYPE } from '../../const';\nimport {\n  ExclamationCircleOutlined,\n  PlusOutlined,\n  EditOutlined,\n  KeyOutlined,\n  MoreOutlined,\n  DeleteOutlined,\n} from '@ant-design/icons';\nimport { Col, Modal, Input, Button, Typography, Row, Popover, AutoComplete, Select } from 'antd';\nconst { Text } = Typography;\nconst { Option } = Select;\nexport interface CustomNodeWidgetProps {\n  node: CustomNodeModel;\n  engine: DiagramEngine;\n  size?: number | undefined;\n}\n\n/**\n * @author Nguyen Tuan Quang\n */\nexport const Port = styled.div`\n  width: 20px;\n  height: 20px;\n  background: #f6f6f6;\n  cursor: pointer;\n  margin-top: 5px;\n\n  &:hover {\n    background: #deecf3;\n  }\n`;\n\nconst styles = {\n  cardHeader: {\n    color: 'white',\n    border: ' 0 solid #e2e8f0',\n    fontWeight: 400,\n    fontSize: '20px',\n    padding: '5px 20px',\n    height: '40px',\n    background: '#316896',\n    marginBottom: '-2px',\n  },\n  rightPort: {\n    width: '20px',\n    height: '20px',\n    position: 'absolute',\n    left: '380px',\n  },\n  leftPort: {\n    width: '20px',\n    height: '20px',\n    position: 'absolute',\n    left: '0',\n  },\n  fieldText: { fontSize: '20px' },\n};\nconst CustomNodeWidget: React.FC<CustomNodeWidgetProps> = (props) => {\n  // const { dispatch } = props;\n\n  const [editNode, setEditNode] = React.useState(false);\n  const [name, setName] = React.useState('');\n  const [hover, setHover] = React.useState('');\n  const ports: { [s: string]: PortModel } = useSelector((state) => state.node.ports);\n  const dispatch = useDispatch();\n  const save = () => {\n    props.node.addCustomPort('new_col', '', '');\n    props.engine.repaintCanvas();\n  };\n  const confirm = () => {\n    Modal.confirm({\n      title: 'Confirm',\n      icon: <ExclamationCircleOutlined />,\n      content: 'Confirm delete table',\n      okText: 'Yes',\n      cancelText: 'No',\n      onOk() {\n        props.node.remove();\n        props.engine.repaintCanvas();\n      },\n    });\n  };\n  const confirmDeletePort = (port: PortModel) => {\n    Modal.confirm({\n      title: 'Confirm',\n      icon: <ExclamationCircleOutlined />,\n      content: 'Confirm delete port',\n      okText: 'Yes',\n      cancelText: 'No',\n      onOk() {\n        props.node.removePort(port);\n        dispatch(action.setPorts(props.node.getPorts()));\n        props.engine.repaintCanvas();\n      },\n    });\n  };\n  const openEdit = () => {\n    setEditNode(true);\n    setName(props.node.getOptions().extras);\n    dispatch(action.setPorts(props.node.getPorts()));\n  };\n  const closeEdit = () => {\n    setEditNode(false);\n    setName('');\n  };\n  const handelChangeName = (e: any) => {\n    setName(e.target.value);\n  };\n  const handleChangePort = (e) => {\n    const { id, name, value } = e.target;\n\n    ports[name].getOptions().extras[id] = value;\n    // dispatch(action.setPorts({ ...ports }));\n  };\n  const submit = () => {\n    props.node.setName(name);\n    closeEdit();\n  };\n  const handleDeleteButton = (e, value) => {\n    e.stopPropagation();\n    if (e.key === 'Delete') {\n      confirmDeletePort(value);\n    }\n  };\n  const handleRowClick = (e, key, value) => {\n    setHover(key);\n    // dispatch(action.setPort(value));\n    props.node.setSelected(false);\n  };\n  const selectTable = (e) => {\n    props.node.setSelected(false);\n    // dispatch(action.setSelectedNode(props.node));\n    // dispatch(action.setActive('table'));\n  };\n  const content = (\n    <Row>\n      <Button\n        type='ghost'\n        icon={<PlusOutlined style={{ color: 'green' }} />}\n        onClick={() => save()}\n      />\n      <Button\n        type='ghost'\n        icon={<EditOutlined style={{ color: 'cyan' }} />}\n        onClick={() => openEdit()}\n      />\n      <Button\n        type='ghost'\n        icon={<DeleteOutlined style={{ color: 'red' }} />}\n        onClick={() => confirm()}\n      />\n    </Row>\n  );\n\n  return (\n    <div>\n      <Modal\n        visible={editNode}\n        onCancel={() => closeEdit()}\n        okText='Save'\n        cancelText='Cancel'\n        onOk={() => submit()}\n      >\n        Name:\n        <Input value={name} name='name' key='name' onChange={handelChangeName} />\n        Body:\n        {ports !== undefined\n          ? Object.entries(ports).map(([key, value], index: any) =>\n              value.getOptions().extras.key === 'PRIMARY KEY' ? (\n                <Row gutter={16} key={index}>\n                  <Col span='10'>\n                    <Input\n                      id='name'\n                      value={value.getOptions().extras.name}\n                      name={key}\n                      key={index}\n                      onChange={handleChangePort}\n                    />\n                  </Col>\n                  <Col span='8'>\n                    <AutoComplete\n                      style={{ width: 150 }}\n                      options={TYPE}\n                      filterOption={(inputValue, option) =>\n                        option.value.toUpperCase().indexOf(inputValue.toUpperCase()) !== -1\n                      }\n                      value={value.getOptions().extras.type}\n                      onChange={(type) => {\n                        value.getOptions().extras.type = type;\n                        dispatch(action.setPorts({ ...ports }));\n                      }}\n                      onSelect={(type) => {\n                        value.getOptions().extras.type = type;\n\n                        dispatch(action.setPorts({ ...ports }));\n                      }}\n                    ></AutoComplete>\n                  </Col>\n                  <Col span='6'>\n                    <Select\n                      defaultValue={value.getOptions().extras.key}\n                      style={{ width: 120 }}\n                      onChange={(key) => {\n                        value.getOptions().extras.key = key;\n                        dispatch(action.setPorts({ ...ports }));\n                      }}\n                    >\n                      <Option value=''>null</Option>\n                      <Option value='PRIMARY KEY'>PRIMARY KEY</Option>\n                    </Select>\n                  </Col>\n                </Row>\n              ) : (\n                ''\n              )\n            )\n          : ''}\n        <hr />\n        {ports !== undefined\n          ? Object.entries(ports).map(([key, value], index: any) =>\n              value.getOptions().extras.key !== 'PRIMARY KEY' ? (\n                <Row gutter={16} key={index} style={{ paddingTop: '5px' }}>\n                  <Col span='10'>\n                    <Input\n                      id='name'\n                      value={value.getOptions().extras.name}\n                      name={key}\n                      key={index}\n                      onChange={handleChangePort}\n                    />\n                  </Col>\n                  <Col span='8'>\n                    <AutoComplete\n                      style={{ width: 150 }}\n                      options={TYPE}\n                      filterOption={(inputValue, option) =>\n                        option.value.toUpperCase().indexOf(inputValue.toUpperCase()) !== -1\n                      }\n                      value={value.getOptions().extras.type}\n                      onChange={(type) => {\n                        value.getOptions().extras.type = type;\n                        dispatch(action.setPorts({ ...ports }));\n                      }}\n                      onSelect={(type) => {\n                        value.getOptions().extras.type = type;\n\n                        dispatch(action.setPorts({ ...ports }));\n                      }}\n                    ></AutoComplete>\n                  </Col>\n                  <Col span='6'>\n                    <Select\n                      defaultValue={value.getOptions().extras.key}\n                      style={{ width: 120 }}\n                      onChange={(key) => {\n                        value.getOptions().extras.key = key;\n                        dispatch(action.setPorts({ ...ports }));\n                      }}\n                    >\n                      <Option value=''>null</Option>\n                      <Option value='PRIMARY KEY'>PRIMARY KEY</Option>\n                    </Select>\n                  </Col>\n                </Row>\n              ) : (\n                ''\n              )\n            )\n          : ''}\n      </Modal>\n      <div\n        className={'custom-node'}\n        style={{\n          position: 'relative',\n          minWidth: props.size * 4,\n          minHeight: props.size,\n        }}\n        onKeyDown={(e) => {\n          e.stopPropagation();\n          if (e.key === 'Delete') {\n            confirm();\n          }\n        }}\n        onClick={(e) => {\n          selectTable(e);\n        }}\n        tabIndex={-1}\n      >\n        <div style={styles.cardHeader}>\n          <p>{props.node.getOptions().extras}</p>\n        </div>\n        <div\n          style={{\n            background: '#F6F6F6',\n            padding: '20px',\n            border: 'none',\n          }}\n        >\n          <div style={{ position: 'absolute', top: '0', right: '0' }}>\n            <Popover placement='rightBottom' content={content} trigger='focus'>\n              <Button\n                type='ghost'\n                style={{ border: 'none' }}\n                icon={\n                  <MoreOutlined style={{ color: 'white', fontSize: '20px', paddingTop: '5px' }} />\n                }\n              />\n            </Popover>\n          </div>\n          {Object.entries(props.node.getPorts()).map(([key, value], index: any) =>\n            value.getOptions().extras.key === 'PRIMARY KEY' ? (\n              <Row\n                key={index}\n                onFocus={() => setHover(key)}\n                onBlur={() => setHover('')}\n                style={{\n                  backgroundColor: hover === key ? '#4770FF' : '',\n                  fontWeight: 'bold',\n                  fontSize: '20px',\n                }}\n              >\n                <PortWidget port={value} engine={props.engine} style={styles.leftPort}>\n                  <Port />\n                </PortWidget>\n                <PortWidget port={value} engine={props.engine} style={styles.rightPort}>\n                  <Port />\n                </PortWidget>\n                <Col span={10}>\n                  <Text>{value.getOptions().extras.name}</Text>\n                </Col>\n                <Col span={8}>\n                  <Text style={{ color: '#dbdd4d' }}>{value.getOptions().extras.type}</Text>\n                </Col>\n                <Col span={3}>\n                  <Text>PK</Text>\n                </Col>\n                <Col span={3}>\n                  <KeyOutlined style={{ color: 'yellow', fontSize: 20 }} />\n                </Col>\n              </Row>\n            ) : (\n              ''\n            )\n          )}\n          <hr />\n\n          {Object.entries(props.node.getPorts()).map(([key, value], index: any) =>\n            value.getOptions().extras.key !== 'PRIMARY KEY' ? (\n              <Row\n                key={index}\n                onClick={(e) => handleRowClick(e, key, value)}\n                onBlur={() => setHover('')}\n                style={{ backgroundColor: hover === key ? '#deecf3' : '' }}\n                onKeyDown={(e) => handleDeleteButton(e, value)}\n                tabIndex={-1}\n              >\n                <PortWidget port={value} engine={props.engine} style={styles.leftPort}>\n                  <Port />\n                </PortWidget>\n                <PortWidget port={value} engine={props.engine} style={styles.rightPort}>\n                  <Port />\n                </PortWidget>\n                <Col lg={10}>\n                  <Text style={styles.fieldText}>{value.getOptions().extras.name}</Text>\n                </Col>\n                <Col lg={8}>\n                  <Text style={styles.fieldText}>{value.getOptions().extras.type}</Text>\n                </Col>\n                <Col lg={3}>\n                  <Text style={styles.fieldText}>{value.getOptions().extras.key}</Text>\n                </Col>\n              </Row>\n            ) : (\n              ''\n            )\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\nexport default CustomNodeWidget;\n"]},"metadata":{},"sourceType":"module"}