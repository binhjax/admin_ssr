{"ast":null,"code":"import \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport * as userService from '@/services/user';\nexport default {\n  namespace: 'user',\n  state: {\n    search: {},\n    data: {\n      list: [],\n      pagination: {}\n    },\n    submitting: false,\n    formTitle: '',\n    formID: '',\n    formVisible: false,\n    formData: {}\n  },\n  effects: {\n    fetch: /*#__PURE__*/_regeneratorRuntime.mark(function fetch(_ref, _ref2) {\n      var search, pagination, call, put, select, params, s, p, response;\n      return _regeneratorRuntime.wrap(function fetch$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              search = _ref.search, pagination = _ref.pagination;\n              call = _ref2.call, put = _ref2.put, select = _ref2.select;\n              params = {};\n\n              if (!search) {\n                _context.next = 9;\n                break;\n              }\n\n              params = _objectSpread(_objectSpread({}, params), search);\n              _context.next = 7;\n              return put({\n                type: 'saveSearch',\n                payload: search\n              });\n\n            case 7:\n              _context.next = 13;\n              break;\n\n            case 9:\n              _context.next = 11;\n              return select(function (state) {\n                return state.user.search;\n              });\n\n            case 11:\n              s = _context.sent;\n\n              if (s) {\n                params = _objectSpread(_objectSpread({}, params), s);\n              }\n\n            case 13:\n              if (!pagination) {\n                _context.next = 19;\n                break;\n              }\n\n              params = _objectSpread(_objectSpread({}, params), pagination);\n              _context.next = 17;\n              return put({\n                type: 'savePagination',\n                payload: pagination\n              });\n\n            case 17:\n              _context.next = 23;\n              break;\n\n            case 19:\n              _context.next = 21;\n              return select(function (state) {\n                return state.user.pagination;\n              });\n\n            case 21:\n              p = _context.sent;\n\n              if (p) {\n                params = _objectSpread(_objectSpread({}, params), p);\n              }\n\n            case 23:\n              _context.next = 25;\n              return call(userService.query, params);\n\n            case 25:\n              response = _context.sent;\n              _context.next = 28;\n              return put({\n                type: 'saveData',\n                payload: response\n              });\n\n            case 28:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, fetch);\n    }),\n    loadForm: /*#__PURE__*/_regeneratorRuntime.mark(function loadForm(_ref3, _ref4) {\n      var payload, put;\n      return _regeneratorRuntime.wrap(function loadForm$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              payload = _ref3.payload;\n              put = _ref4.put;\n              _context2.next = 4;\n              return put({\n                type: 'changeFormVisible',\n                payload: true\n              });\n\n            case 4:\n              _context2.next = 6;\n              return [put({\n                type: 'saveFormType',\n                payload: payload.type\n              }), put({\n                type: 'saveFormTitle',\n                payload: 'New User'\n              }), put({\n                type: 'saveFormID',\n                payload: ''\n              }), put({\n                type: 'saveFormData',\n                payload: {}\n              })];\n\n            case 6:\n              if (!(payload.type === 'E')) {\n                _context2.next = 9;\n                break;\n              }\n\n              _context2.next = 9;\n              return [put({\n                type: 'saveFormTitle',\n                payload: 'Edit user'\n              }), put({\n                type: 'saveFormID',\n                payload: payload.id\n              }), put({\n                type: 'fetchForm',\n                payload: {\n                  id: payload.id\n                }\n              })];\n\n            case 9:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, loadForm);\n    }),\n    fetchForm: /*#__PURE__*/_regeneratorRuntime.mark(function fetchForm(_ref5, _ref6) {\n      var payload, call, put, response;\n      return _regeneratorRuntime.wrap(function fetchForm$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              payload = _ref5.payload;\n              call = _ref6.call, put = _ref6.put;\n              _context3.next = 4;\n              return call(userService.get, payload.id);\n\n            case 4:\n              response = _context3.sent;\n              _context3.next = 7;\n              return put({\n                type: 'saveFormData',\n                payload: response\n              });\n\n            case 7:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, fetchForm);\n    }),\n    submit: /*#__PURE__*/_regeneratorRuntime.mark(function submit(_ref7, _ref8) {\n      var payload, call, put, select, params, formType, success, id, response, _response;\n\n      return _regeneratorRuntime.wrap(function submit$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              payload = _ref7.payload;\n              call = _ref8.call, put = _ref8.put, select = _ref8.select;\n              _context4.next = 4;\n              return put({\n                type: 'changeSubmitting',\n                payload: true\n              });\n\n            case 4:\n              params = _objectSpread({}, payload);\n              _context4.next = 7;\n              return select(function (state) {\n                return state.user.formType;\n              });\n\n            case 7:\n              formType = _context4.sent;\n              success = false;\n\n              if (!(formType === 'E')) {\n                _context4.next = 19;\n                break;\n              }\n\n              _context4.next = 12;\n              return select(function (state) {\n                return state.user.formID;\n              });\n\n            case 12:\n              id = _context4.sent;\n              _context4.next = 15;\n              return call(userService.update, id, params);\n\n            case 15:\n              response = _context4.sent;\n\n              if (response.status === 'OK') {\n                success = true;\n              }\n\n              _context4.next = 23;\n              break;\n\n            case 19:\n              _context4.next = 21;\n              return call(userService.create, params);\n\n            case 21:\n              _response = _context4.sent;\n\n              if (_response.id && _response.id !== '') {\n                success = true;\n              }\n\n            case 23:\n              _context4.next = 25;\n              return put({\n                type: 'changeSubmitting',\n                payload: false\n              });\n\n            case 25:\n              if (!success) {\n                _context4.next = 31;\n                break;\n              }\n\n              _message.success('Saved successfully');\n\n              _context4.next = 29;\n              return put({\n                type: 'changeFormVisible',\n                payload: false\n              });\n\n            case 29:\n              _context4.next = 31;\n              return put({\n                type: 'fetch'\n              });\n\n            case 31:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, submit);\n    }),\n    del: /*#__PURE__*/_regeneratorRuntime.mark(function del(_ref9, _ref10) {\n      var payload, call, put, response;\n      return _regeneratorRuntime.wrap(function del$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              payload = _ref9.payload;\n              call = _ref10.call, put = _ref10.put;\n              _context5.next = 4;\n              return call(userService.del, payload.id);\n\n            case 4:\n              response = _context5.sent;\n\n              if (!(response.status === 'OK')) {\n                _context5.next = 9;\n                break;\n              }\n\n              _message.success('successfully deleted');\n\n              _context5.next = 9;\n              return put({\n                type: 'fetch'\n              });\n\n            case 9:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, del);\n    }),\n    changeStatus: /*#__PURE__*/_regeneratorRuntime.mark(function changeStatus(_ref11, _ref12) {\n      var payload, call, put, select, response, msg, data, newData, i, item;\n      return _regeneratorRuntime.wrap(function changeStatus$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              payload = _ref11.payload;\n              call = _ref12.call, put = _ref12.put, select = _ref12.select;\n\n              if (!(payload.status === 1)) {\n                _context6.next = 8;\n                break;\n              }\n\n              _context6.next = 5;\n              return call(userService.enable, payload.id);\n\n            case 5:\n              response = _context6.sent;\n              _context6.next = 11;\n              break;\n\n            case 8:\n              _context6.next = 10;\n              return call(userService.disable, payload.id);\n\n            case 10:\n              response = _context6.sent;\n\n            case 11:\n              if (!(response.status === 'OK')) {\n                _context6.next = 22;\n                break;\n              }\n\n              msg = 'Successfully activated';\n\n              if (payload.status === 2) {\n                msg = 'Deactivated successfully';\n              }\n\n              _message.success(msg);\n\n              _context6.next = 17;\n              return select(function (state) {\n                return state.user.data;\n              });\n\n            case 17:\n              data = _context6.sent;\n              newData = {\n                list: [],\n                pagination: data.pagination\n              };\n\n              for (i = 0; i < data.list.length; i += 1) {\n                item = data.list[i];\n\n                if (item.id === payload.id) {\n                  item.status = payload.status;\n                }\n\n                newData.list.push(item);\n              }\n\n              _context6.next = 22;\n              return put({\n                type: 'saveData',\n                payload: newData\n              });\n\n            case 22:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, changeStatus);\n    })\n  },\n  reducers: {\n    saveData: function saveData(state, _ref13) {\n      var payload = _ref13.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        data: payload\n      });\n    },\n    saveSearch: function saveSearch(state, _ref14) {\n      var payload = _ref14.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        search: payload\n      });\n    },\n    changeFormVisible: function changeFormVisible(state, _ref15) {\n      var payload = _ref15.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        formVisible: payload\n      });\n    },\n    saveFormTitle: function saveFormTitle(state, _ref16) {\n      var payload = _ref16.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        formTitle: payload\n      });\n    },\n    saveFormType: function saveFormType(state, _ref17) {\n      var payload = _ref17.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        formType: payload\n      });\n    },\n    saveFormID: function saveFormID(state, _ref18) {\n      var payload = _ref18.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        formID: payload\n      });\n    },\n    saveFormData: function saveFormData(state, _ref19) {\n      var payload = _ref19.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        formData: payload\n      });\n    },\n    changeSubmitting: function changeSubmitting(state, _ref20) {\n      var payload = _ref20.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        submitting: payload\n      });\n    }\n  }\n};","map":{"version":3,"sources":["/Users/nguyenthanhbinh/Work/vnshop/admin/src/models/user.js"],"names":["userService","namespace","state","search","data","list","pagination","submitting","formTitle","formID","formVisible","formData","effects","fetch","call","put","select","params","type","payload","user","s","p","query","response","loadForm","id","fetchForm","get","submit","formType","success","update","status","create","del","changeStatus","enable","disable","msg","newData","i","length","item","push","reducers","saveData","saveSearch","changeFormVisible","saveFormTitle","saveFormType","saveFormID","saveFormData","changeSubmitting"],"mappings":"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","sourcesContent":["import { message } from 'antd';\r\nimport * as userService from '@/services/user';\r\n\r\nexport default {\r\n  namespace: 'user',\r\n  state: {\r\n    search: {},\r\n    data: {\r\n      list: [],\r\n      pagination: {},\r\n    },\r\n    submitting: false,\r\n    formTitle: '',\r\n    formID: '',\r\n    formVisible: false,\r\n    formData: {},\r\n  },\r\n  effects: {\r\n    *fetch({ search, pagination }, { call, put, select }) {\r\n      let params = {};\r\n\r\n      if (search) {\r\n        params = { ...params, ...search };\r\n        yield put({\r\n          type: 'saveSearch',\r\n          payload: search,\r\n        });\r\n      } else {\r\n        const s = yield select(state => state.user.search);\r\n        if (s) {\r\n          params = { ...params, ...s };\r\n        }\r\n      }\r\n\r\n      if (pagination) {\r\n        params = { ...params, ...pagination };\r\n        yield put({\r\n          type: 'savePagination',\r\n          payload: pagination,\r\n        });\r\n      } else {\r\n        const p = yield select(state => state.user.pagination);\r\n        if (p) {\r\n          params = { ...params, ...p };\r\n        }\r\n      }\r\n\r\n      const response = yield call(userService.query, params);\r\n      yield put({\r\n        type: 'saveData',\r\n        payload: response,\r\n      });\r\n    },\r\n    *loadForm({ payload }, { put }) {\r\n      yield put({\r\n        type: 'changeFormVisible',\r\n        payload: true,\r\n      });\r\n\r\n      yield [\r\n        put({\r\n          type: 'saveFormType',\r\n          payload: payload.type,\r\n        }),\r\n        put({\r\n          type: 'saveFormTitle',\r\n          payload: 'New User',\r\n        }),\r\n        put({\r\n          type: 'saveFormID',\r\n          payload: '',\r\n        }),\r\n        put({\r\n          type: 'saveFormData',\r\n          payload: {},\r\n        }),\r\n      ];\r\n\r\n      if (payload.type === 'E') {\r\n        yield [\r\n          put({\r\n            type: 'saveFormTitle',\r\n            payload: 'Edit user',\r\n          }),\r\n          put({\r\n            type: 'saveFormID',\r\n            payload: payload.id,\r\n          }),\r\n          put({\r\n            type: 'fetchForm',\r\n            payload: { id: payload.id },\r\n          }),\r\n        ];\r\n      }\r\n    },\r\n    *fetchForm({ payload }, { call, put }) {\r\n      const response = yield call(userService.get, payload.id);\r\n      yield put({\r\n        type: 'saveFormData',\r\n        payload: response,\r\n      });\r\n    },\r\n    *submit({ payload }, { call, put, select }) {\r\n      yield put({\r\n        type: 'changeSubmitting',\r\n        payload: true,\r\n      });\r\n\r\n      const params = { ...payload };\r\n      const formType = yield select(state => state.user.formType);\r\n      let success = false;\r\n      if (formType === 'E') {\r\n        const id = yield select(state => state.user.formID);\r\n        const response = yield call(userService.update, id, params);\r\n        if (response.status === 'OK') {\r\n          success = true;\r\n        }\r\n      } else {\r\n        const response = yield call(userService.create, params);\r\n        if (response.id && response.id !== '') {\r\n          success = true;\r\n        }\r\n      }\r\n\r\n      yield put({\r\n        type: 'changeSubmitting',\r\n        payload: false,\r\n      });\r\n\r\n      if (success) {\r\n        message.success('Saved successfully');\r\n        yield put({\r\n          type: 'changeFormVisible',\r\n          payload: false,\r\n        });\r\n        yield put({\r\n          type: 'fetch',\r\n        });\r\n      }\r\n    },\r\n    *del({ payload }, { call, put }) {\r\n      const response = yield call(userService.del, payload.id);\r\n      if (response.status === 'OK') {\r\n        message.success('successfully deleted');\r\n        yield put({ type: 'fetch' });\r\n      }\r\n    },\r\n    *changeStatus({ payload }, { call, put, select }) {\r\n      let response;\r\n      if (payload.status === 1) {\r\n        response = yield call(userService.enable, payload.id);\r\n      } else {\r\n        response = yield call(userService.disable, payload.id);\r\n      }\r\n\r\n      if (response.status === 'OK') {\r\n        let msg = 'Successfully activated';\r\n        if (payload.status === 2) {\r\n          msg = 'Deactivated successfully';\r\n        }\r\n        message.success(msg);\r\n        const data = yield select(state => state.user.data);\r\n        const newData = { list: [], pagination: data.pagination };\r\n\r\n        for (let i = 0; i < data.list.length; i += 1) {\r\n          const item = data.list[i];\r\n          if (item.id === payload.id) {\r\n            item.status = payload.status;\r\n          }\r\n          newData.list.push(item);\r\n        }\r\n\r\n        yield put({\r\n          type: 'saveData',\r\n          payload: newData,\r\n        });\r\n      }\r\n    },\r\n  },\r\n  reducers: {\r\n    saveData(state, { payload }) {\r\n      return { ...state, data: payload };\r\n    },\r\n    saveSearch(state, { payload }) {\r\n      return { ...state, search: payload };\r\n    },\r\n    changeFormVisible(state, { payload }) {\r\n      return { ...state, formVisible: payload };\r\n    },\r\n    saveFormTitle(state, { payload }) {\r\n      return { ...state, formTitle: payload };\r\n    },\r\n    saveFormType(state, { payload }) {\r\n      return { ...state, formType: payload };\r\n    },\r\n    saveFormID(state, { payload }) {\r\n      return { ...state, formID: payload };\r\n    },\r\n    saveFormData(state, { payload }) {\r\n      return { ...state, formData: payload };\r\n    },\r\n    changeSubmitting(state, { payload }) {\r\n      return { ...state, submitting: payload };\r\n    },\r\n  },\r\n};\r\n"]},"metadata":{},"sourceType":"module"}