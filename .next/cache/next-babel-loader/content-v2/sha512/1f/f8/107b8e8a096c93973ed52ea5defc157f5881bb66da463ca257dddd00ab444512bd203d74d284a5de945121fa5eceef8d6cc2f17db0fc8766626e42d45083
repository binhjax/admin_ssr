{"ast":null,"code":"import _defineProperty from \"/home/tuanquang/admin_ssr/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/home/tuanquang/admin_ssr/node_modules/next/node_modules/@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport * as loginService from '@/services/login';\nexport default {\n  namespace: 'global',\n  state: {\n    title: 'System Management',\n    copyRight: '2020 Vnpay',\n    defaultURL: '/dashboard',\n    collapsed: false,\n    openKeys: [],\n    selectedKeys: [],\n    user: {\n      user_name: 'admin',\n      real_name: 'Administrator',\n      role_names: []\n    },\n    menuPaths: {},\n    menuMap: {},\n    menus: [],\n    jsonDiagram: ''\n  },\n  effects: {\n    menuEvent: /*#__PURE__*/_regeneratorRuntime.mark(function menuEvent(_ref, _ref2) {\n      var pathname, put, select, p, menuPaths, item;\n      return _regeneratorRuntime.wrap(function menuEvent$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              pathname = _ref.pathname;\n              put = _ref2.put, select = _ref2.select;\n              p = pathname;\n\n              if (!(p === '/')) {\n                _context.next = 7;\n                break;\n              }\n\n              _context.next = 6;\n              return select(function (state) {\n                return state.global.defaultURL;\n              });\n\n            case 6:\n              p = _context.sent;\n\n            case 7:\n              _context.next = 9;\n              return select(function (state) {\n                return state.global.menuPaths;\n              });\n\n            case 9:\n              menuPaths = _context.sent;\n              item = menuPaths[p];\n\n              if (item) {\n                _context.next = 13;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 13:\n              if (!(item.parent_path && item.parent_path !== '')) {\n                _context.next = 16;\n                break;\n              }\n\n              _context.next = 16;\n              return put({\n                type: 'changeOpenKeys',\n                payload: item.parent_path.split('/')\n              });\n\n            case 16:\n              _context.next = 18;\n              return put({\n                type: 'changeSelectedKeys',\n                payload: [item.id]\n              });\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, menuEvent);\n    }),\n    fetchUser: /*#__PURE__*/_regeneratorRuntime.mark(function fetchUser(_, _ref3) {\n      var call, put, response;\n      return _regeneratorRuntime.wrap(function fetchUser$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              call = _ref3.call, put = _ref3.put;\n              _context2.next = 3;\n              return call(loginService.getCurrentUser);\n\n            case 3:\n              response = _context2.sent;\n              _context2.next = 6;\n              return put({\n                type: 'saveUser',\n                payload: response\n              });\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, fetchUser);\n    }),\n    fetchMenuTree: /*#__PURE__*/_regeneratorRuntime.mark(function fetchMenuTree(_ref4, _ref5) {\n      var pathname, call, put, response, menuData, menuPaths, menuMap, fillData;\n      return _regeneratorRuntime.wrap(function fetchMenuTree$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              fillData = function _fillData(data) {\n                for (var i = 0; i < data.length; i += 1) {\n                  menuMap[data[i].id] = data[i];\n\n                  if (data[i].router !== '') {\n                    menuPaths[data[i].router] = data[i];\n                  }\n\n                  if (data[i].children && data[i].children.length > 0) {\n                    fillData(data[i].children);\n                  }\n                }\n              };\n\n              pathname = _ref4.pathname;\n              call = _ref5.call, put = _ref5.put;\n              _context3.next = 5;\n              return call(loginService.queryMenuTree);\n\n            case 5:\n              response = _context3.sent;\n              menuData = response.list || [];\n              _context3.next = 9;\n              return put({\n                type: 'saveMenus',\n                payload: menuData\n              });\n\n            case 9:\n              menuPaths = {};\n              menuMap = {};\n              fillData(menuData);\n              _context3.next = 14;\n              return [put({\n                type: 'saveMenuPaths',\n                payload: menuPaths\n              }), put({\n                type: 'saveMenuMap',\n                payload: menuMap\n              }), put({\n                type: 'menuEvent',\n                pathname: pathname\n              })];\n\n            case 14:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, fetchMenuTree);\n    }),\n    setJsonDiagram: /*#__PURE__*/_regeneratorRuntime.mark(function setJsonDiagram(_ref6, _ref7) {\n      var json, call, put;\n      return _regeneratorRuntime.wrap(function setJsonDiagram$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              json = _ref6.json;\n              call = _ref7.call, put = _ref7.put;\n              console.log(json);\n              _context4.next = 5;\n              return put({\n                type: 'setJsonDiagram',\n                payload: localStorage.getItem(json)\n              });\n\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, setJsonDiagram);\n    })\n  },\n  reducers: {\n    changeLayoutCollapsed: function changeLayoutCollapsed(state, _ref8) {\n      var payload = _ref8.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        collapsed: payload\n      });\n    },\n    changeOpenKeys: function changeOpenKeys(state, _ref9) {\n      var payload = _ref9.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        openKeys: payload\n      });\n    },\n    changeSelectedKeys: function changeSelectedKeys(state, _ref10) {\n      var payload = _ref10.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        selectedKeys: payload\n      });\n    },\n    saveUser: function saveUser(state, _ref11) {\n      var payload = _ref11.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        user: payload\n      });\n    },\n    saveMenuPaths: function saveMenuPaths(state, _ref12) {\n      var payload = _ref12.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        menuPaths: payload\n      });\n    },\n    saveMenuMap: function saveMenuMap(state, _ref13) {\n      var payload = _ref13.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        menuMap: payload\n      });\n    },\n    saveMenus: function saveMenus(state, _ref14) {\n      var payload = _ref14.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        menus: payload\n      });\n    },\n    setJsonDiagram: function setJsonDiagram(state, _ref15) {\n      var payload = _ref15.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        jsonDiagram: payload\n      });\n    }\n  },\n  subscriptions: {\n    setup: function setup(_ref16) {\n      var dispatch = _ref16.dispatch,\n          history = _ref16.history;\n\n      if (typeof history !== 'undefined') {\n        history.listen(function (_ref17) {\n          var pathname = _ref17.pathname;\n          dispatch({\n            type: 'menuEvent',\n            pathname: pathname\n          });\n        });\n      }\n    }\n  }\n};","map":{"version":3,"sources":["/home/tuanquang/admin_ssr/src/models/global.js"],"names":["loginService","namespace","state","title","copyRight","defaultURL","collapsed","openKeys","selectedKeys","user","user_name","real_name","role_names","menuPaths","menuMap","menus","jsonDiagram","effects","menuEvent","pathname","put","select","p","global","item","parent_path","type","payload","split","id","fetchUser","_","call","getCurrentUser","response","fetchMenuTree","fillData","data","i","length","router","children","queryMenuTree","menuData","list","setJsonDiagram","json","console","log","localStorage","getItem","reducers","changeLayoutCollapsed","changeOpenKeys","changeSelectedKeys","saveUser","saveMenuPaths","saveMenuMap","saveMenus","subscriptions","setup","dispatch","history","listen"],"mappings":"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","sourcesContent":["import * as loginService from '@/services/login';\n\nexport default {\n  namespace: 'global',\n\n  state: {\n    title: 'System Management',\n    copyRight: '2020 Vnpay',\n    defaultURL: '/dashboard',\n    collapsed: false,\n    openKeys: [],\n    selectedKeys: [],\n    user: {\n      user_name: 'admin',\n      real_name: 'Administrator',\n      role_names: [],\n    },\n    menuPaths: {},\n    menuMap: {},\n    menus: [],\n    jsonDiagram: '',\n  },\n\n  effects: {\n    *menuEvent({ pathname }, { put, select }) {\n      let p = pathname;\n      if (p === '/') {\n        p = yield select(state => state.global.defaultURL);\n      }\n\n      const menuPaths = yield select(state => state.global.menuPaths);\n      const item = menuPaths[p];\n      if (!item) {\n        return;\n      }\n\n      if (item.parent_path && item.parent_path !== '') {\n        yield put({\n          type: 'changeOpenKeys',\n          payload: item.parent_path.split('/'),\n        });\n      }\n\n      yield put({\n        type: 'changeSelectedKeys',\n        payload: [item.id],\n      });\n    },\n    *fetchUser(_, { call, put }) {\n      const response = yield call(loginService.getCurrentUser);\n      yield put({\n        type: 'saveUser',\n        payload: response,\n      });\n    },\n    *fetchMenuTree({ pathname }, { call, put }) {\n      const response = yield call(loginService.queryMenuTree);\n\n      const menuData = response.list || [];\n      yield put({\n        type: 'saveMenus',\n        payload: menuData,\n      });\n\n      const menuPaths = {};\n      const menuMap = {};\n      function fillData(data) {\n        for (let i = 0; i < data.length; i += 1) {\n          menuMap[data[i].id] = data[i];\n          if (data[i].router !== '') {\n            menuPaths[data[i].router] = data[i];\n          }\n          if (data[i].children && data[i].children.length > 0) {\n            fillData(data[i].children);\n          }\n        }\n      }\n      fillData(menuData);\n\n      yield [\n        put({\n          type: 'saveMenuPaths',\n          payload: menuPaths,\n        }),\n        put({\n          type: 'saveMenuMap',\n          payload: menuMap,\n        }),\n        put({\n          type: 'menuEvent',\n          pathname,\n        }),\n      ];\n    },\n    *setJsonDiagram({ json }, { call, put }) {\n      console.log(json);\n      yield put({\n        type: 'setJsonDiagram',\n        payload: localStorage.getItem(json),\n      });\n    },\n  },\n\n  reducers: {\n    changeLayoutCollapsed(state, { payload }) {\n      return {\n        ...state,\n        collapsed: payload,\n      };\n    },\n    changeOpenKeys(state, { payload }) {\n      return {\n        ...state,\n        openKeys: payload,\n      };\n    },\n    changeSelectedKeys(state, { payload }) {\n      return {\n        ...state,\n        selectedKeys: payload,\n      };\n    },\n    saveUser(state, { payload }) {\n      return { ...state, user: payload };\n    },\n    saveMenuPaths(state, { payload }) {\n      return { ...state, menuPaths: payload };\n    },\n    saveMenuMap(state, { payload }) {\n      return { ...state, menuMap: payload };\n    },\n    saveMenus(state, { payload }) {\n      return { ...state, menus: payload };\n    },\n    setJsonDiagram(state, { payload }) {\n      return { ...state, jsonDiagram: payload };\n    },\n  },\n  subscriptions: {\n    setup({ dispatch, history }) {\n      if (typeof history !== 'undefined') {\n        history.listen(({ pathname }) => {\n          dispatch({\n            type: 'menuEvent',\n            pathname,\n          });\n        });\n      }\n    },\n  },\n};\n"]},"metadata":{},"sourceType":"module"}