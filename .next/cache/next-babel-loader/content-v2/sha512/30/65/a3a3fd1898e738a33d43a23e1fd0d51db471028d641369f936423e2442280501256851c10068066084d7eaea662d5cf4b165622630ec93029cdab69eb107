{"ast":null,"code":"import \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nimport _regeneratorRuntime from \"/home/tuanquang/admin_ssr/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _defineProperty from \"/home/tuanquang/admin_ssr/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport * as menuService from '@/services/menu';\nexport default {\n  namespace: 'menu',\n  state: {\n    search: {},\n    pagination: {},\n    data: {\n      list: [],\n      pagination: {}\n    },\n    submitting: false,\n    formType: '',\n    formTitle: '',\n    formID: '',\n    formVisible: false,\n    formData: {},\n    treeData: [],\n    expandedKeys: []\n  },\n  effects: {\n    fetch: /*#__PURE__*/_regeneratorRuntime.mark(function fetch(_ref, _ref2) {\n      var search, pagination, call, put, select, params, s, p, response;\n      return _regeneratorRuntime.wrap(function fetch$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              search = _ref.search, pagination = _ref.pagination;\n              call = _ref2.call, put = _ref2.put, select = _ref2.select;\n              params = {\n                parentID: ''\n              };\n\n              if (!search) {\n                _context.next = 9;\n                break;\n              }\n\n              params = _objectSpread(_objectSpread({}, params), search);\n              _context.next = 7;\n              return put({\n                type: 'saveSearch',\n                payload: search\n              });\n\n            case 7:\n              _context.next = 13;\n              break;\n\n            case 9:\n              _context.next = 11;\n              return select(function (state) {\n                return state.menu.search;\n              });\n\n            case 11:\n              s = _context.sent;\n\n              if (s) {\n                params = _objectSpread(_objectSpread({}, params), s);\n              }\n\n            case 13:\n              if (!pagination) {\n                _context.next = 19;\n                break;\n              }\n\n              params = _objectSpread(_objectSpread({}, params), pagination);\n              _context.next = 17;\n              return put({\n                type: 'savePagination',\n                payload: pagination\n              });\n\n            case 17:\n              _context.next = 23;\n              break;\n\n            case 19:\n              _context.next = 21;\n              return select(function (state) {\n                return state.menu.pagination;\n              });\n\n            case 21:\n              p = _context.sent;\n\n              if (p) {\n                params = _objectSpread(_objectSpread({}, params), p);\n              }\n\n            case 23:\n              _context.next = 25;\n              return call(menuService.query, params);\n\n            case 25:\n              response = _context.sent;\n              _context.next = 28;\n              return put({\n                type: 'saveData',\n                payload: response\n              });\n\n            case 28:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, fetch);\n    }),\n    loadForm: /*#__PURE__*/_regeneratorRuntime.mark(function loadForm(_ref3, _ref4) {\n      var payload, put, select, search;\n      return _regeneratorRuntime.wrap(function loadForm$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              payload = _ref3.payload;\n              put = _ref4.put, select = _ref4.select;\n              _context2.next = 4;\n              return put({\n                type: 'changeFormVisible',\n                payload: true\n              });\n\n            case 4:\n              _context2.next = 6;\n              return [put({\n                type: 'saveFormType',\n                payload: payload.type\n              }), put({\n                type: 'saveFormTitle',\n                payload: 'New menu'\n              }), put({\n                type: 'saveFormID',\n                payload: ''\n              }), put({\n                type: 'saveFormData',\n                payload: {}\n              }), put({\n                type: 'fetchTree'\n              })];\n\n            case 6:\n              if (!(payload.type === 'E')) {\n                _context2.next = 11;\n                break;\n              }\n\n              _context2.next = 9;\n              return [put({\n                type: 'saveFormTitle',\n                payload: 'Edit menu'\n              }), put({\n                type: 'saveFormID',\n                payload: payload.id\n              }), put({\n                type: 'fetchForm',\n                payload: {\n                  id: payload.id\n                }\n              })];\n\n            case 9:\n              _context2.next = 16;\n              break;\n\n            case 11:\n              _context2.next = 13;\n              return select(function (state) {\n                return state.menu.search;\n              });\n\n            case 13:\n              search = _context2.sent;\n              _context2.next = 16;\n              return put({\n                type: 'saveFormData',\n                payload: {\n                  parent_id: search.parentID ? search.parentID : ''\n                }\n              });\n\n            case 16:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, loadForm);\n    }),\n    fetchForm: /*#__PURE__*/_regeneratorRuntime.mark(function fetchForm(_ref5, _ref6) {\n      var payload, call, put, response;\n      return _regeneratorRuntime.wrap(function fetchForm$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              payload = _ref5.payload;\n              call = _ref6.call, put = _ref6.put;\n              _context3.next = 4;\n              return call(menuService.get, payload.id);\n\n            case 4:\n              response = _context3.sent;\n              _context3.next = 7;\n              return put({\n                type: 'saveFormData',\n                payload: response\n              });\n\n            case 7:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, fetchForm);\n    }),\n    submit: /*#__PURE__*/_regeneratorRuntime.mark(function submit(_ref7, _ref8) {\n      var payload, call, put, select, params, formType, success, id, response, _response;\n\n      return _regeneratorRuntime.wrap(function submit$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              payload = _ref7.payload;\n              call = _ref8.call, put = _ref8.put, select = _ref8.select;\n              _context4.next = 4;\n              return put({\n                type: 'changeSubmitting',\n                payload: true\n              });\n\n            case 4:\n              params = _objectSpread({}, payload);\n              _context4.next = 7;\n              return select(function (state) {\n                return state.menu.formType;\n              });\n\n            case 7:\n              formType = _context4.sent;\n              success = false;\n\n              if (!(formType === 'E')) {\n                _context4.next = 19;\n                break;\n              }\n\n              _context4.next = 12;\n              return select(function (state) {\n                return state.menu.formID;\n              });\n\n            case 12:\n              id = _context4.sent;\n              _context4.next = 15;\n              return call(menuService.update, id, params);\n\n            case 15:\n              response = _context4.sent;\n\n              if (response.status === 'OK') {\n                success = true;\n              }\n\n              _context4.next = 23;\n              break;\n\n            case 19:\n              _context4.next = 21;\n              return call(menuService.create, params);\n\n            case 21:\n              _response = _context4.sent;\n\n              if (_response.id && _response.id !== '') {\n                success = true;\n              }\n\n            case 23:\n              _context4.next = 25;\n              return put({\n                type: 'changeSubmitting',\n                payload: false\n              });\n\n            case 25:\n              if (!success) {\n                _context4.next = 33;\n                break;\n              }\n\n              _message.success('Saved successfully');\n\n              _context4.next = 29;\n              return put({\n                type: 'changeFormVisible',\n                payload: false\n              });\n\n            case 29:\n              _context4.next = 31;\n              return put({\n                type: 'fetchTree'\n              });\n\n            case 31:\n              _context4.next = 33;\n              return put({\n                type: 'fetch'\n              });\n\n            case 33:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, submit);\n    }),\n    del: /*#__PURE__*/_regeneratorRuntime.mark(function del(_ref9, _ref10) {\n      var payload, call, put, response;\n      return _regeneratorRuntime.wrap(function del$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              payload = _ref9.payload;\n              call = _ref10.call, put = _ref10.put;\n              _context5.next = 4;\n              return call(menuService.del, payload.id);\n\n            case 4:\n              response = _context5.sent;\n\n              if (!(response.status === 'OK')) {\n                _context5.next = 11;\n                break;\n              }\n\n              _message.success('successfully deleted');\n\n              _context5.next = 9;\n              return put({\n                type: 'fetchTree'\n              });\n\n            case 9:\n              _context5.next = 11;\n              return put({\n                type: 'fetch'\n              });\n\n            case 11:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, del);\n    }),\n    fetchTree: /*#__PURE__*/_regeneratorRuntime.mark(function fetchTree(_ref11, _ref12) {\n      var payload, call, put, params, response;\n      return _regeneratorRuntime.wrap(function fetchTree$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              payload = _ref11.payload;\n              call = _ref12.call, put = _ref12.put;\n              params = {};\n\n              if (payload) {\n                params = _objectSpread(_objectSpread({}, params), payload);\n              }\n\n              _context6.next = 6;\n              return call(menuService.queryTree, params);\n\n            case 6:\n              response = _context6.sent;\n              _context6.next = 9;\n              return put({\n                type: 'saveTreeData',\n                payload: response.list || []\n              });\n\n            case 9:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, fetchTree);\n    }),\n    changeStatus: /*#__PURE__*/_regeneratorRuntime.mark(function changeStatus(_ref13, _ref14) {\n      var payload, call, put, select, response, msg, data, newData, i, item;\n      return _regeneratorRuntime.wrap(function changeStatus$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              payload = _ref13.payload;\n              call = _ref14.call, put = _ref14.put, select = _ref14.select;\n\n              if (!(payload.status === 1)) {\n                _context7.next = 8;\n                break;\n              }\n\n              _context7.next = 5;\n              return call(menuService.enable, payload.id);\n\n            case 5:\n              response = _context7.sent;\n              _context7.next = 11;\n              break;\n\n            case 8:\n              _context7.next = 10;\n              return call(menuService.disable, payload.id);\n\n            case 10:\n              response = _context7.sent;\n\n            case 11:\n              if (!(response.status === 'OK')) {\n                _context7.next = 22;\n                break;\n              }\n\n              msg = 'Successfully activated';\n\n              if (payload.status === 2) {\n                msg = 'Deactivated successfully';\n              }\n\n              _message.success(msg);\n\n              _context7.next = 17;\n              return select(function (state) {\n                return state.menu.data;\n              });\n\n            case 17:\n              data = _context7.sent;\n              newData = {\n                list: [],\n                pagination: data.pagination\n              };\n\n              for (i = 0; i < data.list.length; i += 1) {\n                item = data.list[i];\n\n                if (item.id === payload.id) {\n                  item.status = payload.status;\n                }\n\n                newData.list.push(item);\n              }\n\n              _context7.next = 22;\n              return put({\n                type: 'saveData',\n                payload: newData\n              });\n\n            case 22:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, changeStatus);\n    })\n  },\n  reducers: {\n    saveData: function saveData(state, _ref15) {\n      var payload = _ref15.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        data: payload\n      });\n    },\n    saveSearch: function saveSearch(state, _ref16) {\n      var payload = _ref16.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        search: payload\n      });\n    },\n    savePagination: function savePagination(state, _ref17) {\n      var payload = _ref17.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        pagination: payload\n      });\n    },\n    changeFormVisible: function changeFormVisible(state, _ref18) {\n      var payload = _ref18.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        formVisible: payload\n      });\n    },\n    saveFormType: function saveFormType(state, _ref19) {\n      var payload = _ref19.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        formType: payload\n      });\n    },\n    saveFormTitle: function saveFormTitle(state, _ref20) {\n      var payload = _ref20.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        formTitle: payload\n      });\n    },\n    saveFormID: function saveFormID(state, _ref21) {\n      var payload = _ref21.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        formID: payload\n      });\n    },\n    saveFormData: function saveFormData(state, _ref22) {\n      var payload = _ref22.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        formData: payload\n      });\n    },\n    changeSubmitting: function changeSubmitting(state, _ref23) {\n      var payload = _ref23.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        submitting: payload\n      });\n    },\n    saveTreeData: function saveTreeData(state, _ref24) {\n      var payload = _ref24.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        treeData: payload\n      });\n    },\n    saveExpandedKeys: function saveExpandedKeys(state, _ref25) {\n      var payload = _ref25.payload;\n      return _objectSpread(_objectSpread({}, state), {}, {\n        expandedKeys: payload\n      });\n    }\n  }\n};","map":{"version":3,"sources":["/home/tuanquang/admin_ssr/src/models/menu.js"],"names":["menuService","namespace","state","search","pagination","data","list","submitting","formType","formTitle","formID","formVisible","formData","treeData","expandedKeys","effects","fetch","call","put","select","params","parentID","type","payload","menu","s","p","query","response","loadForm","id","parent_id","fetchForm","get","submit","success","update","status","create","del","fetchTree","queryTree","changeStatus","enable","disable","msg","newData","i","length","item","push","reducers","saveData","saveSearch","savePagination","changeFormVisible","saveFormType","saveFormTitle","saveFormID","saveFormData","changeSubmitting","saveTreeData","saveExpandedKeys"],"mappings":"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","sourcesContent":["import { message } from 'antd';\nimport * as menuService from '@/services/menu';\n\nexport default {\n  namespace: 'menu',\n  state: {\n    search: {},\n    pagination: {},\n    data: {\n      list: [],\n      pagination: {},\n    },\n    submitting: false,\n    formType: '',\n    formTitle: '',\n    formID: '',\n    formVisible: false,\n    formData: {},\n    treeData: [],\n    expandedKeys: [],\n  },\n  effects: {\n    *fetch({ search, pagination }, { call, put, select }) {\n      let params = {\n        parentID: '',\n      };\n\n      if (search) {\n        params = { ...params, ...search };\n        yield put({\n          type: 'saveSearch',\n          payload: search,\n        });\n      } else {\n        const s = yield select(state => state.menu.search);\n        if (s) {\n          params = { ...params, ...s };\n        }\n      }\n\n      if (pagination) {\n        params = { ...params, ...pagination };\n        yield put({\n          type: 'savePagination',\n          payload: pagination,\n        });\n      } else {\n        const p = yield select(state => state.menu.pagination);\n        if (p) {\n          params = { ...params, ...p };\n        }\n      }\n\n      const response = yield call(menuService.query, params);\n      yield put({\n        type: 'saveData',\n        payload: response,\n      });\n    },\n    *loadForm({ payload }, { put, select }) {\n      yield put({\n        type: 'changeFormVisible',\n        payload: true,\n      });\n\n      yield [\n        put({\n          type: 'saveFormType',\n          payload: payload.type,\n        }),\n        put({\n          type: 'saveFormTitle',\n          payload: 'New menu',\n        }),\n        put({\n          type: 'saveFormID',\n          payload: '',\n        }),\n        put({\n          type: 'saveFormData',\n          payload: {},\n        }),\n        put({ type: 'fetchTree' }),\n      ];\n\n      if (payload.type === 'E') {\n        yield [\n          put({\n            type: 'saveFormTitle',\n            payload: 'Edit menu',\n          }),\n          put({\n            type: 'saveFormID',\n            payload: payload.id,\n          }),\n          put({\n            type: 'fetchForm',\n            payload: { id: payload.id },\n          }),\n        ];\n      } else {\n        const search = yield select(state => state.menu.search);\n        yield put({\n          type: 'saveFormData',\n          payload: { parent_id: search.parentID ? search.parentID : '' },\n        });\n      }\n    },\n    *fetchForm({ payload }, { call, put }) {\n      const response = yield call(menuService.get, payload.id);\n      yield put({\n        type: 'saveFormData',\n        payload: response,\n      });\n    },\n    *submit({ payload }, { call, put, select }) {\n      yield put({\n        type: 'changeSubmitting',\n        payload: true,\n      });\n\n      const params = { ...payload };\n      const formType = yield select(state => state.menu.formType);\n      let success = false;\n      if (formType === 'E') {\n        const id = yield select(state => state.menu.formID);\n        const response = yield call(menuService.update, id, params);\n        if (response.status === 'OK') {\n          success = true;\n        }\n      } else {\n        const response = yield call(menuService.create, params);\n        if (response.id && response.id !== '') {\n          success = true;\n        }\n      }\n\n      yield put({\n        type: 'changeSubmitting',\n        payload: false,\n      });\n\n      if (success) {\n        message.success('Saved successfully');\n        yield put({\n          type: 'changeFormVisible',\n          payload: false,\n        });\n\n        yield put({ type: 'fetchTree' });\n        yield put({ type: 'fetch' });\n      }\n    },\n    *del({ payload }, { call, put }) {\n      const response = yield call(menuService.del, payload.id);\n      if (response.status === 'OK') {\n        message.success('successfully deleted');\n        yield put({ type: 'fetchTree' });\n        yield put({ type: 'fetch' });\n      }\n    },\n    *fetchTree({ payload }, { call, put }) {\n      let params = {};\n      if (payload) {\n        params = { ...params, ...payload };\n      }\n      const response = yield call(menuService.queryTree, params);\n      yield put({\n        type: 'saveTreeData',\n        payload: response.list || [],\n      });\n    },\n    *changeStatus({ payload }, { call, put, select }) {\n      let response;\n      if (payload.status === 1) {\n        response = yield call(menuService.enable, payload.id);\n      } else {\n        response = yield call(menuService.disable, payload.id);\n      }\n\n      if (response.status === 'OK') {\n        let msg = 'Successfully activated';\n        if (payload.status === 2) {\n          msg = 'Deactivated successfully';\n        }\n        message.success(msg);\n        const data = yield select(state => state.menu.data);\n        const newData = { list: [], pagination: data.pagination };\n\n        for (let i = 0; i < data.list.length; i += 1) {\n          const item = data.list[i];\n          if (item.id === payload.id) {\n            item.status = payload.status;\n          }\n          newData.list.push(item);\n        }\n\n        yield put({\n          type: 'saveData',\n          payload: newData,\n        });\n      }\n    },\n  },\n  reducers: {\n    saveData(state, { payload }) {\n      return { ...state, data: payload };\n    },\n    saveSearch(state, { payload }) {\n      return { ...state, search: payload };\n    },\n    savePagination(state, { payload }) {\n      return { ...state, pagination: payload };\n    },\n    changeFormVisible(state, { payload }) {\n      return { ...state, formVisible: payload };\n    },\n    saveFormType(state, { payload }) {\n      return { ...state, formType: payload };\n    },\n    saveFormTitle(state, { payload }) {\n      return { ...state, formTitle: payload };\n    },\n    saveFormID(state, { payload }) {\n      return { ...state, formID: payload };\n    },\n    saveFormData(state, { payload }) {\n      return { ...state, formData: payload };\n    },\n    changeSubmitting(state, { payload }) {\n      return { ...state, submitting: payload };\n    },\n    saveTreeData(state, { payload }) {\n      return { ...state, treeData: payload };\n    },\n    saveExpandedKeys(state, { payload }) {\n      return { ...state, expandedKeys: payload };\n    },\n  },\n};\n"]},"metadata":{},"sourceType":"module"}