_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[38],{"1OyB":function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return r}))},"7m+u":function(e,t,n){"use strict";n.r(t);n("mN36");var r=n("N9UN"),a=n.n(r),o=(n("zmYW"),n("DtFj")),c=n.n(o),i=(n("CbT5"),n("RWbP")),s=n.n(i),u=(n("hr7U"),n("9xET")),l=n.n(u),p=(n("MaXC"),n("4IMT")),f=n.n(p),d=(n("fv9D"),n("ZPTe")),b=n.n(d),y=(n("cUip"),n("iJl9")),m=n.n(y),h=(n("fwXI"),n("CC+v")),O=n.n(h),j=n("H+61"),v=n("UlJF"),g=n("+Css"),w=n("7LId"),P=n("VIvw"),C=n("iHvq"),S=n("cpVT"),D=n("q1tI"),k=n.n(D),R=n("WsrF"),_=(n("XlDN"),n("rZaG")),I=n("XZXw"),x=(n("7kJ1"),n("qPIi")),F=n.n(x),E=n("HALo"),T=n("+n12"),N=(n("ek7I"),n("FAat")),q=n.n(N),U=n("1OyB"),A=n("vuIU"),M=n("JX7q"),V=n("Ji7U"),J=n("md7G"),K=n("foSv"),Y=n("rePB"),X=n("03io"),z=k.a.createElement;function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){Object(Y.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(K.a)(e);if(t){var a=Object(K.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(J.a)(this,n)}}function G(e){return e?e.map((function(e){return e.role_id})):[]}var W,Z=function(e){Object(V.a)(n,e);var t=B(n);function n(e){var r;return Object(U.a)(this,n),r=t.call(this,e),Object(Y.a)(Object(M.a)(r),"handleChange",(function(e){r.setState({value:e}),r.triggerChange(e)})),Object(Y.a)(Object(M.a)(r),"triggerChange",(function(e){var t=r.props.onChange;t&&t(e.map((function(e){return{role_id:e}})))})),r.state={value:G(e.value),data:[]},r}return Object(A.a)(n,[{key:"componentDidMount",value:function(){var e=this;Object(X.f)({q:"select"}).then((function(t){e.setState({data:t.list||[]})}))}},{key:"render",value:function(){var e=this.state,t=e.value,n=e.data;return z(q.a,{mode:"tags",value:t,onChange:this.handleChange,placeholder:"Please choose a role",style:{width:"100%"}},n.map((function(e){return z(q.a.Option,{key:e.id,value:e.id},e.name)})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return"value"in e?H(H({},t),{},{value:G(e.value)}):t}}]),n}(D.PureComponent),Q=n("2m8j"),$=k.a.createElement;function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){Object(S.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(C.a)(e);if(t){var a=Object(C.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(P.a)(this,n)}}var re,ae=R.a.create()(W=function(e){Object(w.a)(n,e);var t=ne(n);function n(){var e;Object(j.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),Object(S.a)(Object(g.a)(e),"onOKClick",(function(){var t=e.props,n=t.form,r=t.onSubmit;n.validateFieldsAndScroll((function(e,t){if(!e){var n=te({},t);n.status=parseInt(n.status,10),n.password&&""!==n.password&&(n.password=Object(T.b)(n.password)),r(n)}}))})),Object(S.a)(Object(g.a)(e),"dispatch",(function(t){(0,e.props.dispatch)(t)})),e}return Object(v.a)(n,[{key:"render",value:function(){var e=this.props,t=e.onCancel,n=e.user,r=n.formType,a=n.formTitle,o=n.formVisible,c=n.formData,i=n.submitting,s=e.form.getFieldDecorator,u={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}};return $(O.a,{title:a,width:600,visible:o,maskClosable:!1,confirmLoading:i,destroyOnClose:!0,onOk:this.onOKClick,onCancel:t,style:{top:20},bodyStyle:{maxHeight:"calc( 100vh - 158px )",overflowY:"auto"}},$(R.a,null,$(R.a.Item,Object(E.a)({},u,{label:"Username"}),s("user_name",{initialValue:c.user_name,rules:[{required:!0,message:"please enter username"}]})($(m.a,{placeholder:"please enter username"}))),$(R.a.Item,Object(E.a)({},u,{label:"login password"}),s("password",{initialValue:c.password,rules:[{required:"A"===r,message:"Please enter your password"}]})($(m.a,{type:"password",placeholder:"A"===r?"Please enter your password":"Leave blank to not modify the login password"}))),$(R.a.Item,Object(E.a)({},u,{label:"Actual Name"}),s("real_name",{initialValue:c.real_name,rules:[{required:!0,message:"Please enter your name"}]})($(m.a,{placeholder:"enter your name"}))),$(R.a.Item,Object(E.a)({},u,{label:"User Role"}),s("user_roles",{initialValue:c.user_roles,rules:[{required:!0,message:"Please select the role"}]})($(Z,null))),$(R.a.Item,Object(E.a)({},u,{label:"User Status"}),s("status",{initialValue:c.status?c.status.toString():"1"})($(F.a.Group,null,$(F.a,{value:"1"},"Normal"),$(F.a,{value:"2"},"Deactivate")))),$(R.a.Item,Object(E.a)({},u,{label:"Mailbox"}),s("email",{initialValue:c.email})($(m.a,{placeholder:"Please input your email"}))),$(R.a.Item,Object(E.a)({},u,{label:"Phone Number"}),s("phone",{initialValue:c.phone})($(m.a,{placeholder:"Please enter phone number"})))))}}]),n}(D.PureComponent))||W,oe=Object(Q.a)((function(e){return{user:e.user}}))(ae),ce=n("FjYM"),ie=n.n(ce),se=k.a.createElement;function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){Object(S.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(C.a)(e);if(t){var a=Object(C.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(P.a)(this,n)}}var fe=R.a.create()(re=function(e){Object(w.a)(n,e);var t=pe(n);function n(){var e;Object(j.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),Object(S.a)(Object(g.a)(e),"state",{selectedRowKeys:[],selectedRows:[]}),Object(S.a)(Object(g.a)(e),"onItemDisableClick",(function(t){e.dispatch({type:"user/changeStatus",payload:{id:t.id,status:2}})})),Object(S.a)(Object(g.a)(e),"onItemEnableClick",(function(t){e.dispatch({type:"user/changeStatus",payload:{id:t.id,status:1}})})),Object(S.a)(Object(g.a)(e),"onItemEditClick",(function(t){e.dispatch({type:"user/loadForm",payload:{type:"E",id:t.id}})})),Object(S.a)(Object(g.a)(e),"onAddClick",(function(){e.dispatch({type:"user/loadForm",payload:{type:"A"}})})),Object(S.a)(Object(g.a)(e),"clearSelectRows",(function(){0!==e.state.selectedRowKeys.length&&e.setState({selectedRowKeys:[],selectedRows:[]})})),Object(S.a)(Object(g.a)(e),"onItemDelClick",(function(t){O.a.confirm({title:"Fuzzy query confirm delete [user data: ".concat(t.user_name,"\u3011\uff1f"),okText:"Confirm",okType:"danger",cancelText:"Cancel",onOk:e.onDelOKClick.bind(Object(g.a)(e),t.id)})})),Object(S.a)(Object(g.a)(e),"handleTableSelectRow",(function(t,n){var r=[],a=[];n&&(r.push(t.id),a.push(t)),e.setState({selectedRowKeys:r,selectedRows:a})})),Object(S.a)(Object(g.a)(e),"onTableChange",(function(t){e.dispatch({type:"user/fetch",pagination:{current:t.current,pageSize:t.pageSize}}),e.clearSelectRows()})),Object(S.a)(Object(g.a)(e),"onResetFormClick",(function(){e.props.form.resetFields(),e.dispatch({type:"user/fetch",search:{},pagination:{}})})),Object(S.a)(Object(g.a)(e),"onSearchFormSubmit",(function(t){t&&t.preventDefault(),e.props.form.validateFields({force:!0},(function(t,n){if(!t){var r=le({},n);r.roleIDs&&(r.roleIDs=r.roleIDs.map((function(e){return e.role_id})).join(",")),e.dispatch({type:"user/fetch",search:r,pagination:{}}),e.clearSelectRows()}}))})),Object(S.a)(Object(g.a)(e),"onDataFormSubmit",(function(t){e.dispatch({type:"user/submit",payload:t}),e.clearSelectRows()})),Object(S.a)(Object(g.a)(e),"onDataFormCancel",(function(){e.dispatch({type:"user/changeFormVisible",payload:!1})})),Object(S.a)(Object(g.a)(e),"dispatch",(function(t){(0,e.props.dispatch)(t)})),e}return Object(v.a)(n,[{key:"componentDidMount",value:function(){this.dispatch({type:"user/fetch",search:{},pagination:{}})}},{key:"onDelOKClick",value:function(e){this.dispatch({type:"user/del",payload:{id:e}}),this.clearSelectRows()}},{key:"renderDataForm",value:function(){return se(oe,{onCancel:this.onDataFormCancel,onSubmit:this.onDataFormSubmit})}},{key:"renderSearchForm",value:function(){var e=this.props.form.getFieldDecorator;return se(R.a,{onSubmit:this.onSearchFormSubmit},se(l.a,{gutter:16},se(b.a,{span:8},se(R.a.Item,{label:"Fuzzy query"},e("queryValue")(se(m.a,{placeholder:"Please enter the content to be queried"})))),se(b.a,{span:8},se(R.a.Item,{label:"User Role"},e("roleIDs")(se(Z,null)))),se(b.a,{span:8},se("div",{style:{overflow:"hidden",paddingTop:4}},se(f.a,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),se(f.a,{style:{marginLeft:8},onClick:this.onResetFormClick},"\u91cd\u7f6e")))))}},{key:"render",value:function(){var e=this,t=this.props,n=t.loading,r=t.user.data,o=r.list,i=r.pagination,u=this.state,l=u.selectedRows,p=u.selectedRowKeys,f=[{title:"Username",dataIndex:"user_name"},{title:"Realname",dataIndex:"real_name"},{title:"Roles",dataIndex:"roles",render:function(e){if(!e||0===e.length)return se("span",null,"-");for(var t=[],n=0;n<e.length;n+=1)t.push(e[n].name);return se("span",null,t.join(" | "))}},{title:"User Status",dataIndex:"status",render:function(e){return se(s.a,1===e?{status:"success",text:"Enable"}:{status:"error",text:"Deactivate"})}},{title:"Email",dataIndex:"email"},{title:"Phone Number",dataIndex:"phone"},{title:"Created At",dataIndex:"created_at",render:function(e){return se("span",null,Object(T.a)(e,"YYYY-MM-DD HH:mm"))}}],d=le({showSizeChanger:!0,showQuickJumper:!0,showTotal:function(e){return se("span",null,"Total ",e," pages")}},i);return se(I.a,{title:"User Management"},se(a.a,{bordered:!1},se("div",{className:ie.a.tableList},se("div",{className:ie.a.tableListForm},this.renderSearchForm()),se("div",{className:ie.a.tableListOperator},se(_.a,{code:"add",type:"primary",onClick:function(){return e.onAddClick()}},"New"),1===l.length&&[se(_.a,{key:"edit",code:"edit",onClick:function(){return e.onItemEditClick(l[0])}},"Edit"),se(_.a,{key:"del",code:"del",type:"danger",onClick:function(){return e.onItemDelClick(l[0])}},"Delete"),2===l[0].status&&se(_.a,{key:"enable",code:"enable",onClick:function(){return e.onItemEnableClick(l[0])}},"Enable"),1===l[0].status&&se(_.a,{key:"disable",code:"disable",type:"danger",onClick:function(){return e.onItemDisableClick(l[0])}},"Disable")]),se("div",null,se(c.a,{rowSelection:{selectedRowKeys:p,onSelect:this.handleTableSelectRow},loading:n,rowKey:function(e){return e.id},dataSource:o,columns:f,pagination:d,onChange:this.onTableChange,size:"small"})))),this.renderDataForm())}}]),n}(D.PureComponent))||re;t.default=Object(Q.a)((function(e){return{loading:e.loading.models.user,user:e.user}}))(fe)},BYYP:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/system/user",function(){return n("7m+u")}])},JX7q:function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"a",(function(){return r}))},Ji7U:function(e,t,n){"use strict";function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}n.d(t,"a",(function(){return a}))},cDf5:function(e,t){function n(t){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?(e.exports=n=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=n=function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),n(t)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},foSv:function(e,t,n){"use strict";function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.d(t,"a",(function(){return r}))},md7G:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("cDf5"),a=n.n(r),o=n("JX7q");function c(e,t){return!t||"object"!==a()(t)&&"function"!==typeof t?Object(o.a)(e):t}},vuIU:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,"a",(function(){return a}))}},[["BYYP",0,2,5,1,3,4,6,8,7,10,11,13,12,14,17,15,16,18,19,20,21,9]]]);